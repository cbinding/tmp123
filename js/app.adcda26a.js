(function(e){function t(t){for(var r,o,s=t[0],l=t[1],c=t[2],d=0,p=[];d<s.length;d++)o=s[d],Object.prototype.hasOwnProperty.call(n,o)&&n[o]&&p.push(n[o][0]),n[o]=0;for(r in l)Object.prototype.hasOwnProperty.call(l,r)&&(e[r]=l[r]);u&&u(t);while(p.length)p.shift()();return i.push.apply(i,c||[]),a()}function a(){for(var e,t=0;t<i.length;t++){for(var a=i[t],r=!0,s=1;s<a.length;s++){var l=a[s];0!==n[l]&&(r=!1)}r&&(i.splice(t--,1),e=o(o.s=a[0]))}return e}var r={},n={app:0},i=[];function o(t){if(r[t])return r[t].exports;var a=r[t]={i:t,l:!1,exports:{}};return e[t].call(a.exports,a,a.exports,o),a.l=!0,a.exports}o.m=e,o.c=r,o.d=function(e,t,a){o.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:a})},o.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.t=function(e,t){if(1&t&&(e=o(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var a=Object.create(null);if(o.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)o.d(a,r,function(t){return e[t]}.bind(null,r));return a},o.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return o.d(t,"a",t),t},o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},o.p="/tmp123/";var s=window["webpackJsonp"]=window["webpackJsonp"]||[],l=s.push.bind(s);s.push=t,s=s.slice();for(var c=0;c<s.length;c++)t(s[c]);var u=l;i.push([0,"chunk-vendors"]),a()})({0:function(e,t,a){e.exports=a("56d7")},"034f":function(e,t,a){"use strict";var r=a("85ec"),n=a.n(r);n.a},"1a40":function(e,t,a){},"25c4":function(e,t,a){"use strict";var r=a("2824"),n=a.n(r);n.a},2674:function(e,t,a){},2824:function(e,t,a){},"3ba1":function(e,t,a){"use strict";var r=a("c8fe"),n=a.n(r);n.a},"4afd":function(e,t,a){"use strict";var r=a("68f0"),n=a.n(r);n.a},"56d7":function(e,t,a){"use strict";a.r(t);a("e260"),a("e6cf"),a("cca6"),a("a79d");var r=a("2b0e"),n=a("ed09"),i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("b-container",{staticClass:"border p-0 bg-light",attrs:{fluid:"",id:"container"}},[a("b-row",{attrs:{"no-gutters":"",id:"header"}},[a("b-col",[a("MenuBar")],1)],1),a("vue-splitter",{attrs:{margin:10,defaultPercent:60}},[a("div",{attrs:{slot:"left-pane"},slot:"left-pane"},[a("b-col",[a("MatrixDiagramCY")],1)],1),a("div",{attrs:{slot:"right-pane"},slot:"right-pane"},[a("ItemEditors")],1)])],1)},o=[],s=(a("99af"),function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("b-navbar",{staticClass:"border-bottom",attrs:{toggleable:"sm",id:"nav"}},[a("b-navbar-toggle",{attrs:{target:"nav-collapse"}}),a("b-collapse",{attrs:{id:"nav-collapse","is-nav":""}},[a("b-navbar-nav",[a("b-nav-item-dropdown",{attrs:{text:"File"}},[a("b-dropdown-item-button",{on:{click:e.clearAll}},[a("b-icon-file-earmark-plus",{staticClass:"mr-2"}),a("span",[e._v("New")])],1),a("b-dropdown-item-button",{on:{click:e.openFileDialog}},[a("b-icon-upload",{staticClass:"mr-2"}),a("span",[e._v("Open (JSON)...")]),a("b-form-file",{staticStyle:{display:"none"},attrs:{plain:"",id:"fileOpen",accept:".json"},on:{input:e.fileLoad}})],1),a("b-dropdown-item-button",{on:{click:e.fileSave}},[a("b-icon-download",{staticClass:"mr-2"}),a("span",[e._v("Save (JSON)...")])],1),a("b-dropdown-divider"),a("b-dropdown-item-button",{directives:[{name:"b-modal",rawName:"v-b-modal.modalPeriodsImport",modifiers:{modalPeriodsImport:!0}}]},[a("b-icon-box-arrow-in-left",{staticClass:"mr-2"}),a("span",[e._v("Import Perio.do collection...")]),a("PeriodsImport")],1),a("b-dropdown-item-button",{directives:[{name:"b-modal",rawName:"v-b-modal.modalCsvImport",modifiers:{modalCsvImport:!0}}],on:{click:function(t){return e.setupModal("contexts")}}},[a("b-icon-box-arrow-in-left",{staticClass:"mr-2"}),a("span",[e._v("Import context stratigraphy (CSV)...")]),a("CsvImport",{attrs:{mode:e.csvImportMode}})],1),a("b-dropdown-item-button",{directives:[{name:"b-modal",rawName:"v-b-modal.modalCsvImport",modifiers:{modalCsvImport:!0}}],on:{click:function(t){return e.setupModal("datings")}}},[a("b-icon-box-arrow-in-left",{staticClass:"mr-2"}),a("span",[e._v("Import dating records (CSV)...")])],1),a("b-dropdown-item-button",{attrs:{disabled:""}},[a("b-icon-box-arrow-right",{staticClass:"mr-2"}),a("span",[e._v("Export context stratigraphy (CSV)...")])],1),a("b-dropdown-divider"),a("b-dropdown-item-button",{on:{click:e.exportPartPNG}},[a("b-icon-box-arrow-right",{staticClass:"mr-2"}),a("span",[e._v("Export visible diagram (PNG)...")])],1),a("b-dropdown-item-button",{on:{click:e.exportFullPNG}},[a("b-icon-box-arrow-right",{staticClass:"mr-2"}),a("span",[e._v("Export full diagram (PNG)...")])],1)],1),a("b-nav-item-dropdown",{attrs:{text:"View"}},[a("b-dropdown-item-button",{on:{click:e.zoomIn}},[a("b-icon-zoom-in",{staticClass:"mr-2"}),a("span",[e._v("Zoom in")])],1),a("b-dropdown-item-button",{on:{click:e.zoomOut}},[a("b-icon-zoom-out",{staticClass:"mr-2"}),a("span",[e._v("Zoom out")])],1),a("b-dropdown-item-button",{on:{click:e.zoomFit}},[a("b-icon-arrows-fullscreen",{staticClass:"mr-2"}),a("span",[e._v("Zoom to fit")])],1),a("b-dropdown-divider"),a("b-dropdown-item-button",{on:{click:function(t){return e.redoLayout("dagre")}}},[a("b-icon-diagram-3",{staticClass:"mr-2"}),a("span",[e._v("Redo Layout")])],1)],1),a("b-nav-item-dropdown",{attrs:{text:"Help"}},[a("b-dropdown-item-button",{directives:[{name:"b-modal",rawName:"v-b-modal.modalAbout",modifiers:{modalAbout:!0}}]},[a("b-icon-question-circle",{staticClass:"mr-2"}),a("span",[e._v(e._s("About "+e.store.getters.appName+"..."))]),a("HelpAbout")],1)],1)],1)],1),a("b-navbar-brand",{directives:[{name:"b-modal",rawName:"v-b-modal.modalAbout",modifiers:{modalAbout:!0}}],attrs:{href:"#"}},[a("img",{attrs:{src:"phaser-spacedout-logo.png",width:"94",height:"25",alt:"PHASER"}})])],1)}),l=[],c=(a("d3b7"),a("3ca3"),a("ddb0"),a("2b3d"),function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("b-modal",{attrs:{centered:"",id:"modalCsvImport",title:"Import delimited file"},on:{ok:e.handleOK,cancel:e.handleClose,close:e.handleClose}},[a("div",[e._v("Expected fields:")]),a("div",[e._v(e._s(e.expectedFields.join(", ")))]),a("b-form",{staticClass:"border p-1",attrs:{inline:""}},[a("b-form-file",{attrs:{plain:"",placeholder:"Choose a file or drop it here...","drop-placeholder":"Drop file here...",accept:"text/csv, .csv, .tab, .txt, .tsv",state:Boolean(e.selectedFile)},on:{input:function(t){return e.loadFile(e.selectedFile)}},model:{value:e.selectedFile,callback:function(t){e.selectedFile=t},expression:"selectedFile"}}),a("b-input-group",{staticClass:"py-2",attrs:{prepend:"Delimiter"}},[a("b-form-radio-group",{staticClass:"p-2 border",attrs:{options:e.delimiterOptions,name:"delimiter"},model:{value:e.delimiter,callback:function(t){e.delimiter=t},expression:"delimiter"}})],1),a("b-form-checkbox",{staticClass:"mx-2",attrs:{inline:"",id:"checkbox-header",name:"checkbox-header",value:!0,"unchecked-value":!1},model:{value:e.hasHeader,callback:function(t){e.hasHeader=t},expression:"hasHeader"}},[a("span",[e._v("Has header row?")])]),a("b-form-radio-group",{staticClass:"p-2 border",staticStyle:{display:"none"},attrs:{inline:"",disabled:"",name:"overwriteOrAppend"},model:{value:e.overwriteOrAppend,callback:function(t){e.overwriteOrAppend=t},expression:"overwriteOrAppend"}},[a("b-form-radio",{attrs:{value:"append"}},[e._v("Append or merge with existing data")]),a("b-form-radio",{attrs:{value:"overwrite"}},[e._v("Overwrite all existing data")])],1)],1),a("div",{staticClass:"m-2"},[e._v("Preview:")]),a("div",{staticClass:"overflow-auto",staticStyle:{height:"300px"}},[a("b-table",{attrs:{small:"",striped:"",stacked:"",items:e.parserPreview.data,fields:e.fields}})],1)],1)}),u=[],d=(a("7db0"),a("c975"),a("d81d"),a("4ec9"),a("a9e3"),a("2909")),p=a("b85c"),f=(a("96cf"),a("1da1")),b=a("369b"),m=a.n(b),g=(a("a630"),a("a15b"),a("8ba4"),a("dca8"),a("ac1f"),a("25f0"),a("466d"),a("4d90"),a("5319"),a("498a"),a("e9a7")),v=a.n(g),h=a("98dc"),y=a.n(h),x=function(e){return v()(e)},O=function(e){return y()(e)},w=Object.freeze({BEFORE:"before",AFTER:"after",MEETS:"meets",METBY:"metby",OVERLAPS:"overlaps",OVERLAPPEDBY:"overlappedby",STARTS:"starts",STARTEDBY:"startedby",FINISHES:"finishes",FINISHEDBY:"finishedby",WITHIN:"within",CONTAINS:"contains",EQUALS:"equals"}),D=Object.freeze({ABOVE:"above",BELOW:"below",EQUAL:"equal"}),C=Object.freeze({PHASE:"phase",GROUP:"group",SUBGROUP:"subgroup",CONTEXT:"context",DATING:"dating",PERIOD:"period"}),I=function(){return(new Date).toISOString().replaceAll(/[:.\-Z]/g,"")},k=function(e){return Array.from(e).map((function(e){return e.charCodeAt(0)<128?e.charCodeAt(0).toString(16).padStart(2,"0"):encodeURIComponent(e).replace(/%/g,"").toLowerCase()})).join("")},j=function(e,t){var a=S(e),r=t;return a.length>0&&!isNaN(a)&&(r=parseInt(a)),r},S=function(e){return(e||"").toString().trim()},E=function(e){return S(e).toLowerCase()},Y=function(e,t){var a;return E((null===e||void 0===e||null===(a=e.data)||void 0===a?void 0:a.class)||"")==E(t)},_=function(e){return Y(e,C.CONTEXT)},T=function(e){return!!e&&(!!Number.isInteger(e.minYear)&&(!!Number.isInteger(e.maxYear)&&e.minYear<=e.maxYear))},N=function(e,t){return!(!T(e)||!T(t))&&e.maxYear<t.minYear},P=function(e,t){return N(t,e)},R=function(e,t){return!(!T(e)||!T(t))&&e.maxYear==t.minYear},B=function(e,t){return R(t,e)},L=function(e,t){return!(!T(e)||!T(t))&&(e.minYear<t.minYear&&e.maxYear>t.minYear&&e.maxYear<t.maxYear)},A=function(e,t){return L(t,e)},U=function(e,t){return!(!T(e)||!T(t))&&(e.minYear==t.minYear&&e.maxYear<t.maxYear)},F=function(e,t){return U(t,e)},G=function(e,t){return!(!T(e)||!T(t))&&(e.minYear>t.minYear&&e.maxYear<t.maxYear)},M=function(e,t){return G(t,e)},z=function(e,t){return!(!T(e)||!T(t))&&(e.maxYear==t.maxYear&&e.minYear>t.minYear)},V=function(e,t){return z(t,e)},$=function(e,t){return!(!T(e)||!T(t))&&(e.minYear==t.minYear&&e.maxYear==t.maxYear)},q=function(e,t){var a="";return N(e,t)?a=w.BEFORE:P(e,t)?a=w.AFTER:R(e,t)?a=w.MEETS:B(e,t)?a=w.METBY:L(e,t)?a=w.OVERLAPS:A(e,t)?a=w.OVERLAPPEDBY:U(e,t)?a=w.STARTS:F(e,t)?a=w.STARTEDBY:z(e,t)?a=w.FINISHES:V(e,t)?a=w.FINISHEDBY:G(e,t)?a=w.WITHIN:M(e,t)?a=w.CONTAINS:$(e,t)&&(a=w.EQUALS),a},H=a("4245"),W=a.n(H),X={props:{mode:{type:String,required:!1,default:"contexts",validator:function(e){return-1!==["contexts","datings"].indexOf(e.toLowerCase())}},previewRowCount:{type:Number,required:!1,default:5},defaultDelimiter:{type:String,required:!1,default:","}},setup:function(e){var t=Object(n["c"])("store"),a=Object(n["g"])(e.defaultDelimiter),r=[{value:"\\t",text:"Tab"},{value:",",text:"Comma"},{value:";",text:"Semicolon"},{value:"|",text:"Pipe"},{value:" ",text:"Space"}],i=Object(n["g"])(!0),o=Object(n["g"])(null),s=Object(n["g"])(""),l=Object(n["g"])("append"),c=Object(n["a"])((function(){switch(e.mode.toLowerCase()){case"contexts":return["siteCode","contextNo","contextType","stratRelationship","relatedContextNo"];case"datings":return["identifier","datingType","withinContext","minYear","maxYear"];default:return[]}})),u=Object(n["a"])((function(){var e=(((b||{}).value||{}).meta||{}).fields||[];return e.map((function(e){return{key:e,label:e}}))})),b=Object(n["a"])((function(){var t={delimiter:a.value,encoding:"UTF-8",header:i.value,preview:e.previewRowCount,skipEmptyLines:"greedy"},r=m.a.parse(s.value,t);return r})),g=function(e){if(e){var t=new FileReader;t.onload=function(e){s.value=e.target.result},t.readAsText(e)}},v=function(){var r=Object(f["a"])(regeneratorRuntime.mark((function r(){var n,o,l;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:n={encoding:"UTF-8",delimiter:a.value,header:i.value,skipEmptyLines:"greedy"},o=m.a.parse(s.value,n),"contexts"==e.mode?(l=O(o.data),t.dispatch("clearAll"),t.dispatch("loadMatrixData",l)):"datings"==e.mode&&x(o.data),y();case 4:case"end":return r.stop()}}),r)})));return function(){return r.apply(this,arguments)}}(),h=function(){return y()};Object(n["e"])((function(){return y()}));var y=function(){o.value=null,s.value=""},x=function(){var e=Object(f["a"])(regeneratorRuntime.mark((function e(a){var r,n,i;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:r=Object(p["a"])(a),e.prev=1,i=regeneratorRuntime.mark((function e(){var a,r,i,o,s,l,c,u,d,p;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(r=n.value,i=S(r.identifier),o=S(r.withinContext),s=S(r.datingType),l=j(r.minYear),c=j(r.maxYear),u=t.getters.contexts.find((function(e){return e.data.label==o})),d={data:{label:i,type:s,parent:u?null===(a=u.data)||void 0===a?void 0:a.id:o,dating:{minYear:l,maxYear:c}}},p=t.getters.datings.find((function(e){return e.data.label==i})),!p){e.next=14;break}return e.next=12,t.dispatch("updateNode",W()({},p,d));case 12:e.next=16;break;case 14:return e.next=16,t.dispatch("insertDating",W()({},t.getters.newDating,d));case 16:case"end":return e.stop()}}),e)})),r.s();case 4:if((n=r.n()).done){e.next=8;break}return e.delegateYield(i(),"t0",6);case 6:e.next=4;break;case 8:e.next=13;break;case 10:e.prev=10,e.t1=e["catch"](1),r.e(e.t1);case 13:return e.prev=13,r.f(),e.finish(13);case 16:case"end":return e.stop()}}),e,null,[[1,10,13,16]])})));return function(t){return e.apply(this,arguments)}}(),O=function(e){var t,a=new Map,r=new Map,n=Object(p["a"])(e);try{for(n.s();!(t=n.n()).done;){var i=t.value,o=S(i.siteCode),s=S(i.contextNo).toLowerCase(),l=S(i.contextType).toLowerCase(),c=S(i.stratRelationship).toLowerCase(),u=S(i.relatedContextNo).toLowerCase();if("above"==c&&""!==s&&""!==u){var f="context-".concat(k(s)),b="context-".concat(k(u)),m={data:{id:f,class:"context",label:s,type:l,siteCode:o}};if(a.has(f)){var g=a.get(f);m=W()(g,m)}a.set(f,m),a.has(b)||a.set(b,{data:{id:b,class:"context",label:u,siteCode:o}});var v="".concat(f,"-").concat(b);r.set(v,{data:{id:v,source:f,target:b,type:c}})}}}catch(y){n.e(y)}finally{n.f()}var h={nodes:Object(d["a"])(a.values()),edges:Object(d["a"])(r.values())};return console.log("contextDataToGraph: ".concat(h.nodes.length," nodes, ").concat(h.edges.length," edges")),h};return{expectedFields:c,delimiter:a,delimiterOptions:r,hasHeader:i,selectedFile:o,parserPreview:b,fields:u,overwriteOrAppend:l,handleOK:v,handleClose:h,loadFile:g}}},K=X,Z=a("2877"),J=Object(Z["a"])(K,c,u,!1,null,null,null),Q=J.exports,ee=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("b-modal",{attrs:{centered:"",id:"modalPeriodsImport",title:"Import Perio.do data"},on:{ok:e.handleOK,cancel:e.handleClose,close:e.handleClose}},[a("b-container",{staticClass:"p-0"},[a("b-row",{attrs:{"align-h":"between"}},[a("b-col",[a("b-button",{staticClass:"text-left shadow",attrs:{pill:"",size:"sm",variant:"outline-primary",title:"refresh",alt:"refresh"},on:{click:function(t){return t.stopPropagation(),e.refresh.apply(null,arguments)}}},[a("b-icon-arrow-clockwise",{staticClass:"mr-2"}),a("span",[e._v("Refresh")])],1)],1),a("b-col",[a("b-form-group",{staticClass:"mb-2",attrs:{label:"Filter","label-for":"periods-filter-input","label-cols-sm":"3","label-align-sm":"right","label-size":"sm"},scopedSlots:e._u([{key:"label",fn:function(){return[a("b-icon-search")]},proxy:!0}])},[a("b-form-input",{staticClass:"shadow-sm",attrs:{size:"md",id:"periods-filter-input",type:"search",autocomplete:"off",placeholder:"filter"},model:{value:e.filter,callback:function(t){e.filter=t},expression:"filter"}})],1)],1)],1),a("b-row",[a("b-col",[a("b-overlay",{attrs:{show:e.busy,rounded:"sm"}},[a("b-form-group",{attrs:{label:"Collections","label-for":"collectionList"},scopedSlots:e._u([{key:"label",fn:function(){return[a("span",[e._v("Collections")]),a("b-badge",{staticClass:"border secondary pb-1 m-0 ml-2",attrs:{variant:"outline"}},[a("span",[e._v(e._s(e.collections.length))])])]},proxy:!0}])},[a("b-table",{staticClass:"overflow-auto shadow-sm",staticStyle:{height:"300px"},attrs:{"show-empty":"",id:"periods-table",hover:"",outlined:"",selectable:"",small:"","no-border-collapse":!1,"sticky-header":"300px","select-mode":"single","primary-key":"id",items:e.collections,fields:e.fields,filter:e.filter,"sort-by":e.sortBy,"sort-desc":e.sortDesc},on:{"update:sortBy":function(t){e.sortBy=t},"update:sort-by":function(t){e.sortBy=t},"update:sortDesc":function(t){e.sortDesc=t},"update:sort-desc":function(t){e.sortDesc=t},"row-selected":e.rowSelected}})],1),a("b-form-group",{attrs:{label:"Periods","label-for":"periodsList"},scopedSlots:e._u([{key:"label",fn:function(){return[a("span",[e._v("Periods")]),a("b-badge",{staticClass:"border secondary pb-1 m-0 ml-2",attrs:{variant:"outline"}},[a("span",[e._v(e._s(e.periods.length))])])]},proxy:!0}])},[a("b-list-group",{staticClass:"shadow-sm overflow-auto m-1",staticStyle:{height:"175px"}},e._l(e.periods,(function(t,r){return a("b-list-group-item",{key:r},[a("a",{attrs:{target:"_blank",href:""+e.baseURI+t.id}},[e._v(e._s(t.label))]),e._v("  "),a("span",[e._v("["+e._s(e.periodCoverage(t))+"]")])])})),1)],1)],1)],1)],1)],1)],1)},te=[],ae=(a("4de4"),a("4160"),a("b0c0"),a("07ac"),a("159b"),{setup:function(){var e=Object(n["c"])("store"),t=Object(n["g"])(!1),a="https://n2t.net/ark:/99152/p0d.json",r=Object(n["h"])({}),i=Object(n["g"])(""),o=Object(n["g"])(""),s=Object(n["g"])("title"),l=Object(n["g"])(!1),c=[{key:"title",label:"title",sortable:!0},{key:"year",label:"year",sortable:!0,class:"text-right"},{key:"periods",label:"periods",sortable:!0,class:"text-right"}],u=Object(n["a"])((function(){return(((r.value||{})["@context"]||[])[1]||{})["@base"]||""})),d=Object(n["a"])((function(){var e=(r.value||{}).authorities||null,t=e?Object.values(e):[];return t.filter((function(e){var t;return""!==((null===(t=e.source)||void 0===t?void 0:t.title)||"")})).map((function(e){var t,a;return{id:e.id,title:null===(t=e.source)||void 0===t?void 0:t.title,year:null===(a=e.source)||void 0===a?void 0:a.yearPublished,periods:Object.values(e.periods).length}}))})),p=Object(n["a"])((function(){var e=i.value?b(i.value):[];return e.sort((function(e,t){return e.label>t.label?1:-1}))})),f=function(e){e.length>0&&(i.value=e[0].id)},b=function(e){var t=((r.value||{}).authorities||{})[e],a=t?t.periods:null;return a?Object.values(a):[]},m=function(e){return e.spatialCoverage?e.spatialCoverage.map((function(e){return e.label||""})).filter((function(e){return e})).join(", "):e.spatialCoverageDescription?e.spatialCoverageDescription:""},g=function(e){var t,a,n,i=((r.value||{}).authorities||{})[e];if(!i)return"";var o=((null===(t=i.source)||void 0===t?void 0:t.creators)||[]).map((function(e){return(e.name||"").trim()})).filter((function(e){return e})).join(", "),s=null===(a=i.source)||void 0===a?void 0:a.yearPublished,l=null===(n=i.source)||void 0===n?void 0:n.title;return"<b>".concat(o,"</b> (").concat(s,")<br><i>").concat(l,"</i>")},v=function(){t.value=!0,fetch(a).then((function(e){return e.json()})).then((function(e){r.value=e,t.value=!1})).catch((function(e){console.log(e),t.value=!1}))},h=function(){p.value.forEach((function(t){var a,r,n,i,o,s,l,c;e.dispatch("insertPeriod",{data:{id:"period-".concat(t.id),label:t.label,uri:"".concat(u.value).concat(t.id),description:t.note||"",dating:{minYear:Number((null===(a=t.start)||void 0===a||null===(r=a.in)||void 0===r?void 0:r.year)||(null===(n=t.start)||void 0===n||null===(i=n.in)||void 0===i?void 0:i.earliestYear)),maxYear:Number((null===(o=t.stop)||void 0===o||null===(s=o.in)||void 0===s?void 0:s.year)||(null===(l=t.stop)||void 0===l||null===(c=l.in)||void 0===c?void 0:c.latestYear))}}})}))},y=function(){return r.value=null},x=function(e){return i.value=e};return{busy:t,data:r,selectedID:i,filter:o,sortBy:s,sortDesc:l,collections:d,periods:p,fields:c,baseURI:u,rowSelected:f,periodsForID:b,periodCoverage:m,referenceForID:g,refresh:v,handleOK:h,handleClose:y,selected:x}}}),re=ae,ne=Object(Z["a"])(re,ee,te,!1,null,null,null),ie=ne.exports,oe=function(){var e=this,t=e.$createElement;e._self._c;return e._m(0)},se=[function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("b-modal",{attrs:{centered:"",id:"modalAbout",title:"About "+e.store.getters.appName},scopedSlots:e._u([{key:"modal-footer",fn:function(){return[a("div")]},proxy:!0}])},[a("div",{staticClass:"text-center"},[a("img",{staticClass:"mb-3",attrs:{src:"phaser-spacedout-logo.png",width:"444",height:"118"}}),a("p",[e._v("Version "+e._s(e.store.getters.appVersion))]),a("p",[e._v("A stratigraphic matrix editing tool")]),a("p",[e._v("Created as part of the MATRIX project")]),a("a",{attrs:{target:"_blank",href:"https://stratigraphic.github.io/matrix/"}},[e._v("https://stratigraphic.github.io/matrix/")])])])}],le={setup:function(){var e=Object(n["c"])("store");return{store:e}}},ce=le,ue=Object(Z["a"])(ce,oe,se,!1,null,null,null),de=ue.exports,pe=new r["default"],fe=pe,be={components:{CsvImport:Q,PeriodsImport:ie,HelpAbout:de},setup:function(e,t){var a=Object(n["c"])("store"),r=function(){return document.getElementById("fileOpen").click()},i=function(){t.root.$bvModal.msgBoxConfirm("This will clear all current data, are you sure?",{size:"sm",buttonSize:"sm",centered:!0,okTitle:"Yes",cancelTitle:"No"}).then((function(e){e&&(a.dispatch("clearAll"),t.emit("diagram-clear"))}))},o=Object(n["g"])("contexts"),s=function(e){return o.value=e},l=function(e){if(e){var t=new FileReader;t.onload=function(e){var t=JSON.parse(e.target.result);a.dispatch("loadMatrixData",t)},t.readAsText(e)}},c=function(){var e={about:a.getters.about,elements:{nodes:a.getters.nodes,edges:a.getters.edges}},t="phaser-".concat(I(),".json");u(JSON.stringify(e),t)},u=function(e,t){var a=new Blob([e],{type:"text/plain;charset=utf-8;"});if(navigator.msSaveBlob)navigator.msSaveBlob(a,t);else{var r=document.createElement("a");if(void 0!==r.download){var n=URL.createObjectURL(a);r.setAttribute("href",n),r.setAttribute("download",t),r.style.visibility="hidden",document.body.appendChild(r),r.click(),document.body.removeChild(r)}}},d=function(){return fe.$emit("diagram-export-part-png")},p=function(){return fe.$emit("diagram-export-full-png")},f=function(){return fe.$emit("diagram-zoom-in")},b=function(){return fe.$emit("diagram-zoom-out")},m=function(){return fe.$emit("diagram-zoom-fit")},g=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"dagre";return fe.$emit("diagram-redo-layout",e)};return{setupModal:s,csvImportMode:o,openFileDialog:r,clearAll:i,fileLoad:l,fileSave:c,saveToFile:u,exportPartPNG:d,exportFullPNG:p,zoomIn:f,zoomOut:b,zoomFit:m,redoLayout:g,store:a}}},me=be,ge=(a("4afd"),Object(Z["a"])(me,s,l,!1,null,"16eb6742",null)),ve=ge.exports,he=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("b-tabs",{staticClass:"my-1",attrs:{align:"left","active-nav-item-class":"font-weight-bold"},model:{value:e.tabIndex,callback:function(t){e.tabIndex=t},expression:"tabIndex"}},[e._l(e.nodeClasses.concat(["edge"]),(function(t){return a("b-tab",{key:t,staticClass:"my-2",scopedSlots:e._u([{key:"title",fn:function(){return[a("span",[e._v(e._s(e.capitalize(t))+"s")]),a("b-badge",{staticClass:"border secondary pb-1 m-0 ml-2",attrs:{variant:"outline"}},[a("span",[e._v(e._s(e.itemCount(t)))])])]},proxy:!0}],null,!0)},[a("ItemEditor",{attrs:{itemClass:t}})],1)})),a("b-tab",{scopedSlots:e._u([{key:"title",fn:function(){return[e._v("Validation")]},proxy:!0}])},[a("ValidationAsync")],1),a("b-tab",{scopedSlots:e._u([{key:"title",fn:function(){return[e._v("Temporal")]},proxy:!0}])},[a("TemporalRelationships")],1),a("b-tab",{attrs:{lazy:""},scopedSlots:e._u([{key:"title",fn:function(){return[e._v("Metadata")]},proxy:!0}])},[a("MetaEditor")],1),a("b-tab",{scopedSlots:e._u([{key:"title",fn:function(){return[e._v("Search (experimental)")]},proxy:!0}])},[a("SearchControls")],1)],2)},ye=[],xe=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("b-container",{staticClass:"p-2",attrs:{fluid:""}},[a("ItemTable",{staticClass:"mb-2",attrs:{itemClass:e.itemClass},on:{"item-selected":e.itemSelected,"item-deleted":e.itemDeleted}}),e.fields.includes("redolayout")?a("b-form-row",[a("b-col",{staticStyle:{"text-align":"right"}},[a("b-button",{staticClass:"text-left shadow",attrs:{pill:"",size:"sm",disabled:e.disabled,variant:"outline-primary",title:"redo layout",alt:"redo layout"},on:{click:function(t){return t.stopPropagation(),e.redoCompoundNodeLayout.apply(null,arguments)}}},[a("b-icon-diagram-3",{staticClass:"mr-2"}),a("span",[e._v(e._s("Redo layout for this "+e.itemClass))])],1)],1)],1):e._e(),a("b-form-row",[a("b-col",[e.fields.includes("label")?a("ItemLabel",{attrs:{disabled:e.disabled,label:"Identifier",placeholder:""+e.itemClass},on:{input:e.labelChanged},model:{value:((e.selectedItem||{}).data||{}).label,callback:function(t){e.$set((e.selectedItem||{}).data||{},"label",t)},expression:"((selectedItem || {}).data || {}).label"}}):e._e(),e.fields.includes("uri")?a("ItemLabel",{attrs:{disabled:e.disabled,label:"URI",placeholder:""+e.itemClass},on:{input:e.uriChanged},model:{value:((e.selectedItem||{}).data||{}).uri,callback:function(t){e.$set((e.selectedItem||{}).data||{},"uri",t)},expression:"((selectedItem || {}).data || {}).uri"}}):e._e(),e.fields.includes("period")?a("ItemLookup",{attrs:{label:"Period",disabled:e.disabled,placeholder:"period",options:e.periodLookupOptions},on:{change:e.periodChanged},model:{value:((e.selectedItem||{}).data||{}).period,callback:function(t){e.$set((e.selectedItem||{}).data||{},"period",t)},expression:"((selectedItem || {}).data || {}).period"}}):e._e(),e.fields.includes("meetsPhase")?a("ItemLookup",{attrs:{label:"Meets",disabled:e.disabled,placeholder:"meets phase",options:e.phaseLookupOptions},on:{change:e.phaseMeetsChanged},model:{value:((e.selectedItem||{}).data||{}).meets,callback:function(t){e.$set((e.selectedItem||{}).data||{},"meets",t)},expression:"((selectedItem || {}).data || {}).meets"}}):e._e(),e.fields.includes("type")?a("ItemLookup",{attrs:{label:"Type",mode:"input",disabled:e.disabled,placeholder:e.itemClass+" type",options:e.typeLookupOptions},on:{change:e.typeChanged},model:{value:((e.selectedItem||{}).data||{}).type,callback:function(t){e.$set((e.selectedItem||{}).data||{},"type",t)},expression:"((selectedItem || {}).data || {}).type"}}):e._e(),e.fields.includes("cud")?a("ItemLookup",{attrs:{label:"Construction/Use/Disuse",disabled:e.disabled,options:[{value:"C",text:"construction"},{value:"U",text:"use"},{value:"D",text:"disuse"},{value:"CU",text:"construction & use"},{value:"CD",text:"construction & disuse"},{value:"UD",text:"use & disuse"},{value:"CUD",text:"construction & use & disuse"}]},on:{change:e.cudChanged},model:{value:((e.selectedItem||{}).data||{}).cud,callback:function(t){e.$set((e.selectedItem||{}).data||{},"cud",t)},expression:"((selectedItem || {}).data || {}).cud"}}):e._e()],1),a("b-col",[e.fields.includes("parent")?a("ItemLookup2",{staticClass:"shadow-sm",attrs:{label:"Within",disabled:e.disabled,placeholder:e.itemClass+" parent",options:e.parentLookupOptions},on:{change:e.parentChanged},model:{value:((e.selectedItem||{}).data||{}).parent,callback:function(t){e.$set((e.selectedItem||{}).data||{},"parent",t)},expression:"((selectedItem || {}).data || {}).parent"}}):e._e(),e.fields.includes("contains")?a("b-form-group",{attrs:{label:"Contains","label-for":"itemContains"}},[a("b-list-group",{staticClass:"shadow-sm overflow-auto",staticStyle:{height:"200px"},attrs:{name:"itemContains",disabled:e.disabled}},e._l(e.itemContains,(function(t,r){return a("b-list-group-item",{key:r,staticClass:"px-2 py-1 m-0"},[a("a",{attrs:{href:"#"},on:{click:function(a){return e.store.dispatch("setSelectedID",t.data.id)}}},[e._v(e._s(e.store.getters.labelByID(t.data.id,!0)))])])})),1)],1):e._e(),e.fields.includes("periodContains")?a("ItemList",{attrs:{label:"Contains",disabled:!0,items:e.periodContains}}):e._e()],1)],1),a("b-form-row",[a("b-col",[e.fields.includes("description")?a("b-form-group",{attrs:{label:"Description","label-for":"itemDescription"}},[a("b-form-textarea",{staticClass:"shadow-sm",attrs:{disabled:e.disabled,placeholder:e.itemClass+" description",rows:"2","max-rows":"2",name:"itemDescription"},on:{change:e.descriptionChanged},model:{value:((e.selectedItem||{}).data||{}).description,callback:function(t){e.$set((e.selectedItem||{}).data||{},"description","string"===typeof t?t.trim():t)},expression:"((selectedItem || {}).data || {}).description"}})],1):e._e()],1)],1),a("b-form-row",[a("b-col",[e.fields.includes("yearrange")?a("DatingYearRangeCE",{attrs:{disabled:e.disabled,dating:((e.selectedItem||{}).data||{}).dating},on:{change:e.datingChanged}}):e._e(),e.fields.includes("scidating")?a("SciDating",{attrs:{disabled:e.disabled,dating:((e.selectedItem||{}).data||{}).dating},on:{change:e.datingChanged}}):e._e()],1)],1),a("b-form-row",[a("b-col",[e.fields.includes("included")?a("b-form-checkbox",{attrs:{disabled:e.disabled,value:!0,"unchecked-value":!1,name:"check-button",switch:""},on:{change:e.includeChanged},model:{value:((e.selectedItem||{}).data||{}).included,callback:function(t){e.$set((e.selectedItem||{}).data||{},"included",t)},expression:"((selectedItem || {}).data || {}).included"}},[e._v("Included in calculations")]):e._e()],1),a("b-col",[e.fields.includes("association")?a("b-form-group",{attrs:{label:"Association","label-for":"itemAssociation"}},[a("b-form-select",{staticClass:"shadow-sm",attrs:{disabled:this.disabled,name:"itemAssociation",options:[{value:"direct",text:"direct"},{value:"residual",text:"residual"},{value:"intrusive",text:"intrusive"},{value:"other",text:"other"}]},on:{change:e.associationChanged},model:{value:((e.selectedItem||{}).data||{}).association,callback:function(t){e.$set((e.selectedItem||{}).data||{},"association",t)},expression:"((selectedItem || {}).data || {}).association"}})],1):e._e()],1)],1),e.fields.includes("stratigraphy")?a("b-form-row",[a("b-col",[e._m(0)],1)],1):e._e()],1)},Oe=[function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("Stratigraphy",{attrs:{sourceID:((e.selectedItem||{}).data||{}).id,disabled:e.disabled}})}],we=(a("caad"),a("2532"),function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("b-container",{staticClass:"p-0",attrs:{fluid:""}},[a("b-row",{attrs:{"align-h":"between"}},[a("b-col",["edge"!==e.itemClass?a("b-button",{staticClass:"text-left shadow",attrs:{pill:"",size:"sm",variant:"outline-primary",title:"add "+e.itemClass,alt:"add "+e.itemClass},on:{click:function(t){return t.stopPropagation(),e.insertItem()}}},[a("b-icon-plus"),e._v("Add "+e._s(e.itemClass))],1):e._e()],1),a("b-col",[a("b-form-group",{staticClass:"mb-2",attrs:{label:"Filter","label-for":"filter-input","label-cols-sm":"3","label-align-sm":"right","label-size":"sm"},scopedSlots:e._u([{key:"label",fn:function(){return[a("b-icon-search")]},proxy:!0}])},[a("b-form-input",{staticClass:"shadow-sm",attrs:{size:"md",id:"filter-input",type:"search",autocomplete:"off",placeholder:"filter "+e.itemClass+" records"},model:{value:e.filter,callback:function(t){e.filter=t},expression:"filter"}})],1)],1)],1),a("b-row",[a("b-col",[a("b-table",{staticClass:"overflow-auto shadow-sm",staticStyle:{height:"250px"},attrs:{"show-empty":"",id:"datatable-"+e.itemClass,"sort-icon-left":"",hover:"",outlined:"",selectable:"",small:"","no-border-collapse":!0,"sticky-header":"300px","select-mode":"single","primary-key":"data.id",items:e.items,fields:e.fields,filter:e.filter},on:{"row-selected":e.rowSelected},scopedSlots:e._u([{key:"cell(actions)",fn:function(t){return[a("div",{staticClass:"text-right"},[a("b-icon-x-circle",{staticClass:"action mr-2",attrs:{width:"15",height:"15",title:"delete "+e.itemClass+" "+t.item.data.label,alt:"delete "+e.itemClass},on:{click:function(a){return a.stopPropagation(),e.deleteItem(t.item)}}})],1)]}},{key:"cell(source)",fn:function(t){return[a("a",{attrs:{href:"#"},on:{click:function(a){return e.store.dispatch("setSelectedID",t.item.data.source)}}},[e._v(e._s(e.store.getters.labelByID(t.item.data.source,!0)))])]}},{key:"cell(target)",fn:function(t){return[a("a",{attrs:{href:"#"},on:{click:function(a){return e.store.dispatch("setSelectedID",t.item.data.target)}}},[e._v(e._s(e.store.getters.labelByID(t.item.data.target,!0)))])]}},{key:"cell(parent)",fn:function(t){return[a("a",{attrs:{href:"#"},on:{click:function(a){return e.store.dispatch("setSelectedID",t.item.data.parent)}}},[e._v(e._s(e.store.getters.labelByID(t.item.data.parent,!0)))])]}},{key:"cell(included)",fn:function(t){return[a("span",{class:t.item.data.included?"text-success":"text-danger"},[e._v(e._s(t.item.data.included?"✓":"✗"))])]}}])})],1)],1)],1)}),De=[],Ce={props:{itemClass:{type:String,required:!1,default:C.PHASE,validator:function(e){return[].concat(Object(d["a"])(Object.values(C)),["edge"]).includes(e)}}},setup:function(e,t){var a=Object(n["c"])("store"),r=Object(n["g"])(""),i=Object(n["g"])("data.label"),o=Object(n["g"])(!1),s=25,l=Object(n["g"])(1),c=Object(n["a"])((function(){return a.getters.selectedID}));Object(n["j"])(c,(function(t){var a=document.getElementById("datatable-".concat(e.itemClass,"__row_").concat(t));a&&(a.click(),a.scrollIntoView({behavior:"smooth",block:"center",inline:"nearest"}),a.scrollIntoViewIfNeeded(!0))}));var u=Object(n["a"])((function(){switch(e.itemClass){case C.PHASE:return a.getters.phases;case C.GROUP:return a.getters.groups;case C.SUBGROUP:return a.getters.subgroups;case C.CONTEXT:return a.getters.contexts;case C.DATING:return a.getters.datings;case C.PERIOD:return a.getters.periods;case"edge":return a.getters.edges;default:return[]}})),p=Object(n["a"])((function(){return u.value.length})),f=Object(n["a"])((function(){switch(e.itemClass){case C.PHASE:return["label","enteredMinYear","enteredMaxYear","enteredDiff","derivedMinYear","derivedMaxYear","duration","period"];case C.GROUP:return["label","type","parent","derivedMinYear","derivedMaxYear","duration","period"];case C.SUBGROUP:return["label","type","parent","derivedMinYear","derivedMaxYear","duration","period"];case C.CONTEXT:return["label","type","parent","derivedMinYear","derivedMaxYear","duration","period"];case C.DATING:return["label","type","parent","enteredMinYear","enteredMaxYear","enteredDiff","included","period"];case C.PERIOD:return["label","enteredMinYear","enteredMaxYear","enteredDiff"];case"edge":return["source","type","target","derivedMinDuration","derivedMaxDuration"];default:return[]}})),b=Object(n["a"])((function(){return[].concat(Object(d["a"])(f.value.includes("label")?[{key:"data.label",label:"id",sortable:!0}]:[]),Object(d["a"])(f.value.includes("period")?[{key:"period",label:"period",sortByFormatted:!0,formatter:y,sortable:!0}]:[]),Object(d["a"])(f.value.includes("source")?[{key:"source",label:"source",sortable:!0}]:[]),Object(d["a"])(f.value.includes("type")?[{key:"data.type",label:"type",sortable:!0}]:[]),Object(d["a"])(f.value.includes("target")?[{key:"target",label:"target",sortable:!0}]:[]),Object(d["a"])(f.value.includes("parent")?[{key:"parent",label:"within",sortable:!0}]:[]),Object(d["a"])(f.value.includes("enteredMinYear")?[{key:"minyear",label:"entered min year",sortByFormatted:!0,formatter:O,sortable:!0,class:"text-right"}]:[]),Object(d["a"])(f.value.includes("enteredMaxYear")?[{key:"maxyear",label:"entered max year",sortByFormatted:!0,formatter:w,sortable:!0,class:"text-right"}]:[]),Object(d["a"])(f.value.includes("enteredDiff")?[{key:"entereddiff",label:"duration",sortByFormatted:!0,formatter:j,sortable:!0,class:"text-right"}]:[]),Object(d["a"])(f.value.includes("derivedMinYear")?[{key:"derivedminyear",label:"derived min year",sortByFormatted:!0,formatter:D,sortable:!0,class:"text-right"}]:[]),Object(d["a"])(f.value.includes("derivedMaxYear")?[{key:"derivedmaxyear",label:"derived max year",sortByFormatted:!0,formatter:I,sortable:!0,class:"text-right"}]:[]),Object(d["a"])(f.value.includes("duration")?[{key:"duration",label:"duration",sortByFormatted:!0,formatter:k,sortable:!0,class:"text-right"}]:[]),Object(d["a"])(f.value.includes("derivedMinDuration")?[{key:"derivedminduration",label:"min duration",sortByFormatted:!0,formatter:S,sortable:!0,class:"text-right"}]:[]),Object(d["a"])(f.value.includes("derivedMaxDuration")?[{key:"derivedmaxduration",label:"max duration",sortByFormatted:!0,formatter:E,sortable:!0,class:"text-right"}]:[]),Object(d["a"])(f.value.includes("included")?[{key:"included",label:"included",sortable:!0,class:"text-center"}]:[]),[{key:"actions",label:""}])})),m=function(){switch(e.itemClass){case C.PHASE:a.dispatch("insertPhase");break;case C.GROUP:a.dispatch("insertGroup");break;case C.SUBGROUP:a.dispatch("insertSubGroup");break;case C.CONTEXT:a.dispatch("insertContext");break;case C.DATING:a.dispatch("insertDating");break;case C.PERIOD:a.dispatch("insertPeriod");break}},g=function(t){t&&("edge"==e.itemClass?a.dispatch("updateEdge",t):a.dispatch("updateNode",t))},v=function(r){var n="Delete ".concat(e.itemClass,' "').concat(r.data.label,'" - are you sure?');t.root.$bvModal.msgBoxConfirm(n).then((function(n){n&&(t.emit("item-deleted",r.data.id),"edge"==e.itemClass?a.dispatch("deleteEdge",r):a.dispatch("deleteNode",r))}))},h=function(e){e.length>0&&t.emit("item-selected",e[0])},y=function(e,t,r){return a.getters.labelByID(r.data.period,!1)},x=function(e,t,a){return null==e||""==e?"":0==t?Number(e):"".concat(e,"±").concat(t).concat("years"==a?"y":"%")},O=function(e,t,a){var r,n=(null===(r=a.data)||void 0===r?void 0:r.dating)||{},i=n.minYear,o=n.minYearTolValue,s=n.minYearTolUnit;return x(i,o,s)},w=function(e,t,a){var r,n=(null===(r=a.data)||void 0===r?void 0:r.dating)||{},i=n.maxYear,o=n.maxYearTolValue,s=n.maxYearTolUnit;return x(i,o,s)},D=function(e,t,r){return a.getters.derivedDates(r.data.id).minYear},I=function(e,t,r){return a.getters.derivedDates(r.data.id).maxYear},k=function(e,t,r){return a.getters.derivedDuration(r.data.id)},j=function(e,t,r){return a.getters.enteredDuration(r.data.id)},S=function(e,t,r){return a.getters.derivedMinDuration(r.data.id)},E=function(e,t,r){return a.getters.derivedMaxDuration(r.data.id)};return{store:a,filter:r,sortBy:i,sortDesc:o,items:u,columns:f,fields:b,perPage:s,currentPage:l,rowCount:p,insertItem:m,updateItem:g,deleteItem:v,rowSelected:h,tablePeriodFormatter:y,tableMinYearFormatter:O,tableMaxYearFormatter:w,derivedMinYearFormatter:D,derivedMaxYearFormatter:I,derivedMinDurationFormatter:S,derivedMaxDurationFormatter:E,durationFormatter:k,enteredDiffFormatter:j}}},Ie=Ce,ke=(a("e732"),Object(Z["a"])(Ie,we,De,!1,null,"2d93f052",null)),je=ke.exports,Se=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",["select"==e.mode?a("b-form-group",{attrs:{label:this.label,"label-for":"itemSelector"}},[a("b-form-select",{staticClass:"shadow-sm",attrs:{variant:"primary",disabled:e.disabled,name:"itemSelector",placeholder:e.placeholder,value:e.value,options:e.optionsForSelect},on:{change:function(t){return e.changed(t)}}})],1):a("b-form-group",{attrs:{label:this.label,"label-for":"itemInput"}},[a("b-form-input",{staticClass:"shadow-sm",attrs:{text:"",size:"sm",disabled:e.disabled,name:"itemInput",placeholder:e.placeholder,value:e.value,type:"text",list:e.optionsId,autocomplete:"off"},on:{change:function(t){return e.changed(t)}}}),a("b-form-datalist",{attrs:{id:e.optionsId,options:e.optionsForInput}})],1)],1)},Ee=[],Ye={props:{disabled:{type:Boolean,required:!1,default:!1},label:{type:String,required:!1,default:"Select item"},placeholder:{type:String,required:!1,default:""},value:{type:String},optionNone:{type:Boolean,required:!1,default:!0},mode:{type:String,required:!1,default:"select",validator:function(e){return["select","input"].includes(e)}},options:{type:Array,required:!1,default:function(){return[]}}},setup:function(e,t){var a=O("datalist-"),r=Object(n["a"])((function(){return e.options.concat(e.optionNone?[{value:"",text:"(none)",selected:!0}]:[]).sort((function(e,t){return(e.text||e.value||"")>(t.text||t.value||"")?1:-1}))})),i=Object(n["a"])((function(){return e.options.map((function(e){return e.text||""})).filter((function(e){return e})).sort((function(e,t){return e>t?1:-1}))})),o=function(e){return t.emit("change",e)};return{optionsId:a,optionsForSelect:r,optionsForInput:i,changed:o}}},_e=Ye,Te=Object(Z["a"])(_e,Se,Ee,!1,null,null,null),Ne=Te.exports,Pe=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",["select"==e.mode?a("b-form-group",{attrs:{label:this.label,"label-for":"itemSelector"}},[a("b-dropdown",{staticClass:"shadow-sm",attrs:{block:"",split:"",size:"sm",name:"itemSelector",disabled:e.disabled,text:e.store.getters.labelByID(e.value,!0),value:e.value,"menu-class":"w-100","split-variant":"link bg-white border-secondary","split-href":"#",variant:"primary border-secondary"},scopedSlots:e._u([{key:"button-content",fn:function(){return[a("a",{attrs:{href:"#"},on:{click:function(t){return e.store.dispatch("setSelectedID",e.value)}}},[e._v(e._s(e.store.getters.labelByID(e.value,!0)))])]},proxy:!0}],null,!1,1791879896)},[a("div",{staticStyle:{height:"200px","overflow-y":"scroll"}},[e.optionNone?a("b-dropdown-item",{staticClass:"ml-3",on:{click:function(t){return e.changed("")}}},[e._v("(none)")]):e._e(),a("b-dropdown-divider"),e._l(e.optionsForSelect,(function(t){return a("b-dropdown-group",{key:t.value,attrs:{header:t.label}},[e._l(t.options,(function(t){return a("b-dropdown-item-button",{key:t.value,staticClass:"ml-3",on:{click:function(a){return e.changed(t.value)}}},[e._v(e._s(t.text))])})),a("b-dropdown-divider")],2)}))],2)])],1):a("b-form-group",{attrs:{label:this.label,"label-for":"itemInput"}},[a("b-form-input",{staticClass:"shadow-sm",attrs:{text:"",disabled:e.disabled,name:"itemInput",placeholder:e.placeholder,value:e.value,type:"text",list:e.optionsId,autocomplete:"off"},on:{change:function(t){return e.changed(t)}}}),a("b-form-datalist",{attrs:{id:e.optionsId,options:e.optionsForInput}})],1)],1)},Re=[],Be={props:{disabled:{type:Boolean,required:!1,default:!1},label:{type:String,required:!1,default:"Select item"},placeholder:{type:String,required:!1,default:""},value:{type:String},optionNone:{type:Boolean,required:!1,default:!0},mode:{type:String,required:!1,default:"select",validator:function(e){return["select","input"].includes(e)}},options:{type:Array,required:!1,default:function(){return[]}}},setup:function(e,t){var a=Object(n["c"])("store"),r=O("datalist-"),i=Object(n["a"])((function(){return e.options.sort((function(e,t){return(e.text||e.value||"")>(t.text||t.value||"")?1:-1}))})),o=Object(n["a"])((function(){return e.options.map((function(e){return e.text||""})).filter((function(e){return e})).sort((function(e,t){return e>t?1:-1}))})),s=function(e){return t.emit("change",e)};return{store:a,optionsId:r,optionsForSelect:i,optionsForInput:o,changed:s}}},Le=Be,Ae=(a("3ba1"),Object(Z["a"])(Le,Pe,Re,!1,null,"2d72ded1",null)),Ue=Ae.exports,Fe=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("b-form-group",{attrs:{label:"Stratigraphy"}},[a("b-form-row",[a("b-col",[a("b-form-group",{attrs:{label:"Source context"}},[a("b-form-input",{staticClass:"shadow-sm",attrs:{text:"",disabled:!0,placeholder:"source",type:"text",name:"itemID",value:e.store.getters.labelByID(e.sourceID)}})],1)],1),a("b-col",[a("b-form-group",{attrs:{label:"Relationship"}},[a("b-form-select",{staticClass:"shadow-sm",attrs:{disabled:this.disabled,name:"edgeTypeSelector",placeholder:"relationship",options:e.edgeTypes.map((function(e){return{value:e,text:e}}))},model:{value:e.selectedEdgeType,callback:function(t){e.selectedEdgeType=t},expression:"selectedEdgeType"}})],1)],1),a("b-col",[a("b-form-group",{attrs:{label:"Target context"}},[a("ItemLookup",{attrs:{label:"",disabled:e.disabled,optionNone:!1,options:e.available,placeholder:"target"},on:{change:e.targetChanged},model:{value:e.selectedTargetID,callback:function(t){e.selectedTargetID=t},expression:"selectedTargetID"}})],1)],1),a("b-col",[a("b-form-group",{attrs:{label:"."}},[a("b-button",{staticClass:"text-left shadow",attrs:{pill:"",size:"sm",disabled:e.disabled||""==e.sourceID,variant:"outline-primary",title:"add",alt:"add"},on:{click:function(t){return t.stopPropagation(),e.addItem.apply(null,arguments)}}},[a("b-icon-plus"),a("span",[e._v("Add relationship")])],1)],1)],1)],1),a("b-form-row",[e._l(e.edgeTypes,(function(t){return a("b-col",{key:t,staticClass:"border"},[a("b-form-group",{attrs:{label:e.capitalize(t)}},[a("ul",{staticClass:"list-inline d-inline-block m-1",attrs:{name:"lst"}},e._l(e.items(t),(function(t){return a("li",{key:t.id,staticClass:"list-inline-item"},[a("b-badge",{staticClass:"bg-white text-dark border border-secondary shadow-sm",attrs:{title:t.id,disabled:e.disabled}},[a("span",[e._v(e._s(e.store.getters.labelByID(t.data.target)))]),a("b-icon-x-circle",{staticClass:"action ml-2",on:{click:function(a){return a.stopPropagation(),e.removeItem(t)}}})],1)],1)})),0)])],1)})),a("b-col")],2)],1)],1)},Ge=[],Me={components:{ItemLookup:Ne},props:{disabled:{type:Boolean,required:!1,default:!1},sourceID:{type:String,required:!1,default:""}},setup:function(e){var t=Object(n["c"])("store"),a=["above","below","equal"],r=Object(n["g"])(""),i=Object(n["g"])("above"),o=Object(n["a"])((function(){return t.getters.edgesBySource(e.sourceID)})),s=Object(n["a"])((function(){return t.getters.contextOptionsGrouped})),l=Object(n["a"])((function(){var t=o.value.map((function(e){var t;return null===(t=e.data)||void 0===t?void 0:t.target})).concat([e.sourceID]),a=s.value.length>0&&s.value[0].options||[];return a.filter((function(e){return!t.includes(e.value)}))})),c=function(e){switch(e){case"above":return o.value.filter((function(e){return"above"==e.data.type}));case"below":return o.value.filter((function(e){return"below"==e.data.type}));case"equal":return o.value.filter((function(e){return"equal"==e.data.type}));default:return[]}},u=function(){var a={data:{source:e.sourceID,target:r.value,type:i.value}};t.dispatch("insertEdge",a)},d=function(e){return t.dispatch("deleteEdge",e)},p=function(e){return r.value=e};return{store:t,items:c,addItem:u,removeItem:d,edgeTypes:a,selectedEdgeType:i,selectedTargetID:r,available:l,targetChanged:p,capitalize:x}}},ze=Me,Ve=(a("ef14"),Object(Z["a"])(ze,Fe,Ge,!1,null,"239e31e0",null)),$e=Ve.exports,qe=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("b-form-group",{staticClass:"px-2 shadow-sm",attrs:{label:""}},[a("b-form-row",[a("b-col",[a("b-form-group",{attrs:{"valid-feedback":"","invalid-feedback":e.validationMessage,state:e.validateMinYear}},[a("DatingYearCE",{attrs:{label:"Minimum (earliest) Year",disabled:e.disabled,placeholder:"Minimum year",name:"minYearInput",year:e.local.minYear},on:{change:function(t){return e.changed("minYear",t)}}}),e.showTolerances?a("DatingYearTolerance",{attrs:{disabled:e.disabled,"tolerance-value":e.local.minYearTolValue,"tolerance-unit":e.local.minYearTolUnit},on:{"change-value":function(t){return e.changed("minYearTolValue",t)},"change-unit":function(t){return e.changed("minYearTolUnit",t)}}}):e._e()],1)],1),a("b-col",[a("b-form-group",{attrs:{"valid-feedback":"","invalid-feedback":e.validationMessage,state:e.validateMaxYear}},[a("DatingYearCE",{attrs:{label:"Maximum (latest) year",disabled:e.disabled,year:e.local.maxYear,placeholder:"Maximum year",name:"maxYearInput"},on:{change:function(t){return e.changed("maxYear",t)}}}),e.showTolerances?a("DatingYearTolerance",{attrs:{disabled:e.disabled,"tolerance-value":e.local.maxYearTolValue,"tolerance-unit":e.local.maxYearTolUnit},on:{"change-value":function(t){return e.changed("maxYearTolValue",t)},"change-unit":function(t){return e.changed("maxYearTolUnit",t)}}}):e._e()],1)],1)],1)],1)},He=[],We=a("ade3"),Xe=a("5530"),Ke=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("b-input-group",{staticClass:"shadow-sm",attrs:{prepend:"±"}},[a("b-form-input",{attrs:{number:"",min:"0",disabled:e.disabled,placeholder:"tolerance",type:"number",value:e.toleranceValue},on:{change:e.valueChanged}}),a("b-input-group-append",[a("b-form-select",{attrs:{value:e.toleranceUnit,options:e.tolUnits,disabled:e.disabled},on:{change:e.unitChanged}})],1)],1)},Ze=[],Je={props:{disabled:{type:Boolean,required:!1,default:!1},toleranceValue:{type:Number,required:!1,default:0},toleranceUnit:{type:String,required:!1,default:"years",validator:function(e){return-1!==["years","percent"].indexOf(e)}}},setup:function(e,t){var a=[{value:"years",text:"years"},{value:"percent",text:"%"}],r=function(e){return t.emit("change-value",j(e,0))},n=function(e){return t.emit("change-unit",e)};return{tolUnits:a,valueChanged:r,unitChanged:n}}},Qe=Je,et=Object(Z["a"])(Qe,Ke,Ze,!1,null,null,null),tt=et.exports,at=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("b-form-group",{attrs:{label:e.label,"label-for":"yearInput"}},[a("b-input-group",{staticClass:"shadow-sm"},[a("b-form-input",{attrs:{number:"",min:"0",disabled:e.disabled,placeholder:e.placeholder,name:"yearInput",type:"number",value:e.yearDisplay},on:{input:function(t){return e.yearChanged(t)}}}),a("b-input-group-append",[a("b-form-checkbox",{attrs:{button:"","button-variant":"secondary",disabled:e.disabled,value:e.isYearBCE},on:{change:function(t){return e.suffixChanged(t)}}},[e._v(e._s(e.isYearBCE?"BCE":"CE"))])],1)],1)],1)},rt=[],nt={props:{disabled:{type:Boolean,required:!1,default:!1},label:{type:String,required:!1,default:"Year"},placeholder:{type:String,required:!1,default:"year"},year:{type:Number,required:!1,default:null}},setup:function(e,t){var a=Object(n["a"])({get:function(){return Math.abs(e.year)},set:function(e){i(e)}}),r=Object(n["a"])({get:function(){return e.year<0},set:function(e){o(e)}}),i=function(e){t.emit("change",e*(r.value?-1:1))},o=function(e){t.emit("change",a.value*(e?1:-1))};return{yearDisplay:a,isYearBCE:r,yearChanged:i,suffixChanged:o}}},it=nt,ot=Object(Z["a"])(it,at,rt,!1,null,null,null),st=ot.exports,lt={components:{DatingYearCE:st,DatingYearTolerance:tt},props:{disabled:{type:Boolean,required:!1,default:!1},dating:{type:Object,required:!1,default:function(){return{}}},showTolerances:{type:Boolean,required:!1,default:!0}},setup:function(e,t){var a=(new Date).getFullYear(),r=Object(n["a"])((function(){var t=e.dating||{};return{minYear:Number(t["minYear"]||null),maxYear:Number(t["maxYear"]||null),minYearTolValue:Number(t["minYearTolValue"]||0),maxYearTolValue:Number(t["maxYearTolValue"]||0),minYearTolUnit:t["minYearTolUnit"]||"years",maxYearTolUnit:t["maxYearTolUnit"]||"years"}})),i=Object(n["a"])((function(){return Number.isInteger(r.value.minYear)&&r.value.minYear<=r.value.maxYear&&r.value.minYear<=a})),o=Object(n["a"])((function(){return Number.isInteger(r.value.maxYear)&&r.value.minYear<=r.value.maxYear&&r.value.maxYear<=a})),s=Object(n["a"])((function(){return Number.isInteger(r.value.minYear)&&Number.isInteger(r.value.maxYear)?r.value.minYear>r.value.maxYear?"Min year cannot exceed max year":r.value.minYear>a?"Min year cannot exceed current year":"something else wrong":"Please enter a valid year"})),l=function(a,r){t.emit("change",Object(Xe["a"])({},e.dating,Object(We["a"])({},a,r)))};return{local:r,validateMinYear:i,validateMaxYear:o,validationMessage:s,changed:l}}},ct=lt,ut=Object(Z["a"])(ct,qe,He,!1,null,"a6b87d8a",null),dt=ut.exports,pt=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("b-form-checkbox",{attrs:{switch:"",id:"sciDating",name:"sciDating",disabled:e.disabled,checked:(e.dating||{}).isSciDating,value:!0,"unchecked-value":!1},on:{change:e.checkboxChanged}},[e._v("Scientific dating?")]),(e.dating||{}).isSciDating?a("SciDatingFields",{attrs:{disabled:e.disabled,dating:e.dating},on:{change:e.datingChanged}}):a("DatingYearRangeCE",{attrs:{disabled:e.disabled,dating:e.dating},on:{change:e.datingChanged}})],1)},ft=[],bt=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("b-form-group",{staticClass:"px-2 shadow-sm",attrs:{label:"Raw Dates: 14C age in 14C yr BP"},scopedSlots:e._u([{key:"label",fn:function(){return[a("span",[e._v("Raw Dates: ")]),a("span",{staticStyle:{"font-style":"italic"}},[e._v("14C age in 14C yr BP")])]},proxy:!0}])},[a("b-form-row",[a("b-col",[a("b-form-group",{staticClass:"my-2",attrs:{label:"Minimum (Earliest) year","label-for":"minRawYearInput"}},[a("b-form-input",{staticClass:"shadow-sm",attrs:{string:"",disabled:e.disabled,placeholder:"14C age in 14C yr BP",name:"minRawYearInput",value:e.local.label},on:{change:function(t){return e.changed("label",t)}}})],1),a("b-input-group",{staticClass:"my-2",attrs:{prepend:"±",append:"years"}},[a("b-form-input",{staticClass:"shadow-sm",attrs:{string:"",disabled:e.disabled,placeholder:"Error Value +/-",name:"errorValue",value:e.local.errorValue},on:{change:function(t){return e.changed("errorValue",t)}}})],1)],1),a("b-col",[a("b-form-group",{staticClass:"my-2",attrs:{label:"Laboratory code for determination","label-for":"labCode"}},[a("b-input-group",{attrs:{prepend:"Lab Code"}},[a("b-form-input",{staticClass:"shadow-sm",attrs:{string:"",disabled:e.disabled,placeholder:"Laboratory code",name:"labCode",value:e.local.labCode},on:{change:function(t){return e.changed("labCode",t)}}})],1)],1),a("b-input-group",{staticClass:"my-2"},[a("b-form-input",{staticClass:"shadow-sm",attrs:{string:"",disabled:e.disabled,placeholder:"The sample code of material dated",name:"sampleCode",value:e.local.sampleCode},on:{change:function(t){return e.changed("sampleCode",t)}}})],1)],1)],1)],1),a("b-form-group",{staticClass:"px-2 shadow-sm",attrs:{label:"Calibrated Dates"}},[a("b-form-row",[a("b-col",[a("b-form-group",{staticClass:"my-2",attrs:{label:"Minimum (Earliest) year","label-for":"minYearInput"}},[a("b-form-input",{staticClass:"shadow-sm",attrs:{number:"",disabled:e.disabled,placeholder:"Minimum year",name:"minYearInput",value:e.local.minYear},on:{change:function(t){return e.changed("minYear",t)}}})],1),a("b-input-group",{staticClass:"my-2"},[a("b-form-input",{staticClass:"shadow-sm",attrs:{string:"",disabled:e.disabled,placeholder:"1st/2nd/3rd Sigma?",name:"minYearSigma",value:e.local.minYearSigma},on:{change:function(t){return e.changed("minYearSigma",t)}}})],1)],1),a("b-col",[a("b-form-group",{staticClass:"my-2",attrs:{label:"Maximum (Latest) year","label-for":"maxYearInput"}},[a("b-form-input",{staticClass:"shadow-sm",attrs:{number:"",disabled:e.disabled,placeholder:"Maximum year",name:"maxYearInput",value:e.local.maxYear},on:{change:function(t){return e.changed("maxYear",t)}}})],1),a("b-input-group",{staticClass:"my-2"},[a("b-form-input",{staticClass:"shadow-sm",attrs:{string:"",disabled:e.disabled,placeholder:"1st/2nd/3rd Sigma?",name:"maxYearSigma",value:e.local.maxYearSigma},on:{change:function(t){return e.changed("maxYearSigma",t)}}})],1)],1)],1)],1)],1)},mt=[],gt={props:{disabled:{type:Boolean,required:!1,default:!1},dating:{type:Object,required:!1,default:null}},setup:function(e,t){var a=Object(n["a"])((function(){var t=e.dating||{};return{minYear:Number(t["minYear"]||null),maxYear:Number(t["maxYear"]||null),minYearTolValue:Number(t["minYearTolValue"]||0),maxYearTolValue:Number(t["maxYearTolValue"]||0),minYearTolUnit:t["minYearTolUnit"]||"years",maxYearTolUnit:t["maxYearTolUnit"]||"years",minYearSigma:t["minYearSigma"]||"",maxYearSigma:t["maxYearSigma"]||"",label:t["label"]||"",labCode:t["labCode"]||"",sampleCode:t["sampleCode"]||"",errorValue:t["errorValue"]||""}})),r=function(a,r){return t.emit("change",Object(Xe["a"])({},e.dating,Object(We["a"])({},a,r)))};return{local:a,changed:r}}},vt=gt,ht=Object(Z["a"])(vt,bt,mt,!1,null,null,null),yt=ht.exports,xt={components:{DatingYearRangeCE:dt,SciDatingFields:yt},props:{disabled:{type:Boolean,required:!1,default:!1},dating:{type:Object,required:!1,default:null}},setup:function(e,t){var a=function(e){return t.emit("change",e)},r=function(t){if(e.dating){var r=Object.assign({},e.dating);r.isSciDating=t,a(r)}};return{datingChanged:a,checkboxChanged:r}}},Ot=xt,wt=Object(Z["a"])(Ot,pt,ft,!1,null,null,null),Dt=wt.exports,Ct=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("b-form-group",{attrs:{label:e.label,"label-for":"itemLabel"}},[a("b-form-input",{staticClass:"shadow-sm",attrs:{text:"",size:"sm",id:e.identifier,disabled:e.disabled,placeholder:e.placeholder,value:e.value,type:"text",name:"itemLabel",autocomplete:"off",variant:"primary"},on:{input:e.changed}})],1)},It=[],kt={props:{id:{type:String,required:!1,default:null},disabled:{type:Boolean,required:!1,default:!1},placeholder:{type:String,required:!1,default:""},value:{type:String,required:!1,default:""},label:{type:String,required:!1,default:"Identifier"}},setup:function(e,t){var a=Object(n["a"])((function(){return e.id||O("itemlabel-")})),r=function(e){return t.emit("input",e)};return{identifier:a,changed:r}}},jt=kt,St=Object(Z["a"])(jt,Ct,It,!1,null,null,null),Et=St.exports,Yt=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("b-form-group",{attrs:{label:e.label,"label-for":"itemContains"}},[a("b-list-group",{staticClass:"overflow-auto",staticStyle:{height:"200px"},attrs:{disabled:e.disabled}},e._l(e.itemsSorted,(function(t,r){return a("b-list-group-item",{key:r,staticClass:"p-0 m-0"},[e._v(e._s(t))])})),1)],1)},_t=[],Tt=(a("fb6a"),{props:{disabled:{type:Boolean,required:!1,default:!1},label:{type:String,required:!1,default:"Contains"},items:{type:Array,required:!1,default:function(){return[]}}},setup:function(e){var t=Object(n["a"])((function(){return e.items.slice().sort((function(e,t){return e>t?1:-1}))}));return{itemsSorted:t}}}),Nt=Tt,Pt=(a("a347"),Object(Z["a"])(Nt,Yt,_t,!1,null,"1a8f317a",null)),Rt=Pt.exports,Bt={name:"ItemEditor",components:{ItemTable:je,ItemLookup:Ne,ItemLookup2:Ue,Stratigraphy:$e,DatingYearRangeCE:dt,SciDating:Dt,ItemLabel:Et,ItemList:Rt},props:{itemClass:{type:String,required:!1,default:C.PHASE,validator:function(e){return[].concat(Object(d["a"])(Object.values(C)),["edge"]).includes(e)}}},setup:function(e){var t=Object(n["c"])("store"),a=Object(n["g"])(null),r=Object(n["a"])((function(){return null===a.value})),i=Object(n["a"])((function(){switch(e.itemClass){case C.PHASE:return["label","description","contains","containsGroups","containsSubGroups","containsContexts","yearrange","redolayout","period","temporal"];case C.GROUP:return["label","type","parent","contains","containsSubGroups","containsContexts","description","redolayout","cud","period","temporal"];case C.SUBGROUP:return["label","type","parent","contains","containsContexts","description","redolayout","cud","period","temporal"];case C.CONTEXT:return["label","type","parent","contains","containsDatings","description","stratigraphy","cud","period","temporal"];case C.DATING:return["label","type","parent","description","scidating","included","association","period"];case C.PERIOD:return["label","uri","description","periodContains","yearrange"];default:return[]}})),o=Object(n["a"])((function(){return t.getters.periodOptions})),s=Object(n["a"])((function(){return t.getters.phaseOptions})),l=Object(n["a"])((function(){switch(e.itemClass){case C.GROUP:return t.getters.phaseOptionsGrouped;case C.SUBGROUP:return t.getters.groupOptionsGrouped;case C.CONTEXT:return t.getters.contextParentOptions;case C.DATING:return t.getters.contextOptionsGrouped;default:return[]}})),c=Object(n["a"])((function(){switch(e.itemClass){case C.PHASE:return t.getters.phaseTypeOptions;case C.GROUP:return t.getters.groupTypeOptions;case C.SUBGROUP:return t.getters.groupTypeOptions;case C.CONTEXT:return t.getters.contextTypeOptions;case C.DATING:return t.getters.datingTypeOptions;default:return[]}})),u=Object(n["a"])((function(){var e,r="";return a.value&&(r=(null===(e=a.value.data)||void 0===e?void 0:e.id)||""),""!==r?t.getters.descendantsOfID(r):[]})),d=Object(n["a"])((function(){var e,r,n="";return a.value&&(null===(e=a.value.data)||void 0===e?void 0:e.class)==C.PERIOD&&(n=(null===(r=a.value.data)||void 0===r?void 0:r.id)||""),""!==n?t.getters.nodes.filter((function(e){return e.data.period==n})).map((function(e){return"(".concat(e.data.class,") ").concat(e.data.label)})):[]})),p=function(e){var r;a.value=e,t.dispatch("setSelectedID",null===(r=Object(n["i"])(a).data)||void 0===r?void 0:r.id)},f=function(e){var t;a.value&&((null===(t=a.value.data)||void 0===t?void 0:t.id)==e&&(a.value=null))},b=function(){return j()},m=function(){return j()},g=function(){return j()},v=function(){a.value&&fe.$emit("diagram-redo-compound-layout",Object(n["i"])(a))},h=function(e){a.value&&a.value.data.parent!=e&&(a.value.data.parent=e,fe.$emit("node-parent-changed",Object(n["i"])(a)),j())},y=function(e){a.value&&(a.value.data.type=e,j())},x=function(e){a.value&&(a.value.data.dating=e,j())},O=function(e){a.value&&(a.value.data.included=e,j())},w=function(e){a.value&&(a.value.data.association=e,j())},D=function(e){a.value&&(a.value.data.cud=e,j())},I=function(e){a.value&&(a.value.data.period=e,j())},k=function(e){a.value&&(a.value.data.meets=e,j())},j=function(){t.dispatch("updateNode",Object(n["i"])(a))};return{store:t,selectedItem:a,disabled:r,fields:i,parentLookupOptions:l,typeLookupOptions:c,phaseLookupOptions:s,itemContains:u,periodContains:d,periodLookupOptions:o,itemSelected:p,itemDeleted:f,labelChanged:b,uriChanged:m,descriptionChanged:g,redoCompoundNodeLayout:v,parentChanged:h,typeChanged:y,datingChanged:x,includeChanged:O,associationChanged:w,cudChanged:D,periodChanged:I,phaseMeetsChanged:k,itemChanged:j}}},Lt=Bt,At=(a("b8b2"),Object(Z["a"])(Lt,xe,Oe,!1,null,"28a33602",null)),Ut=At.exports,Ft=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("b-container",{staticClass:"p-2",attrs:{fluid:""}},[a("b-row",{attrs:{"align-h":"between"}},[a("b-col",[a("b-button",{staticClass:"text-left shadow",attrs:{pill:"",size:"sm",disabled:e.isBusy,variant:"outline-primary",title:"Redo validation",alt:"Redo validation"},on:{click:function(t){return t.stopPropagation(),e.refresh()}}},[a("b-icon-arrow-clockwise"),e._v("Redo validation")],1)],1),a("b-col",[a("b-form-group",{staticClass:"mb-2",attrs:{label:"Filter","label-for":"filter-input","label-cols-sm":"3","label-align-sm":"right","label-size":"sm"},scopedSlots:e._u([{key:"label",fn:function(){return[a("b-icon-search")]},proxy:!0}])},[a("b-form-input",{staticClass:"shadow-sm",attrs:{size:"md",id:"filter-input",type:"search",autocomplete:"off",placeholder:"filter validation records"},model:{value:e.filter,callback:function(t){e.filter=t},expression:"filter"}})],1)],1)],1),a("b-row",[a("b-col",[a("b-table",{staticClass:"overflow-auto shadow-sm mb-2",staticStyle:{height:"600px"},attrs:{"show-empty":"",id:"datatable",busy:e.isBusy,"sort-icon-left":"",hover:"",outlined:"",small:"","no-border-collapse":!0,"sticky-header":"600px","select-mode":"single","primary-key":"id",items:e.tests,fields:e.fields,filter:e.filter,"tbody-tr-class":e.tableRowClass},scopedSlots:e._u([{key:"table-busy",fn:function(){return[a("div",{staticClass:"text-center text-danger my-2"},[a("b-spinner",{staticClass:"align-middle"}),a("strong",[e._v("Validating...")])],1)]},proxy:!0},{key:"cell(actions)",fn:function(t){return[t.item.failed.value>0?a("b-icon-caret-down",{attrs:{title:"show details",size:"sm"},on:{click:t.toggleDetails}}):e._e()]}},{key:"row-details",fn:function(t){return[a("b-list-group",[t.item.failed.value>0?a("b-list-group-item",{attrs:{variant:t.item.optional?"warning":"danger"}},[a("strong",[a("span",[e._v(e._s(t.item.failed.value+" failed"))]),t.item.failed.value>50?a("span",{staticClass:"ml-1"},[e._v("(showing first 50 only)")]):e._e(),a("span",[e._v(":"),a("br")])]),e._l(t.item.failedIDs.value.slice(0,50),(function(t){return a("a",{key:t,staticClass:"mr-2",attrs:{href:"#"},on:{click:function(a){return a.stopPropagation(),e.setSelectedID(t)}}},[e._v(e._s(e.store.getters.labelByID(t,!0)))])}))],2):e._e()],1)]}}])})],1)],1)],1)},Gt=[],Mt=(a("45fc"),a("262e")),zt=a("2caf"),Vt=a("d4ec"),$t=a("bee2"),qt={setup:function(){var e=Object(n["c"])("store"),t=Object(n["g"])(!1),a=Object(n["g"])(""),r=Object(n["g"])("test"),i=Object(n["g"])(!1),o=[{key:"result",label:"result",sortByFormatted:!0,formatter:function(e,t,a){return Object(n["i"])(a.failed)>0?"✗":Object(n["i"])(a.tested)>0?"✓":"-"},sortable:!0,class:"text-center"},{key:"testName",label:"description",formatter:function(e,t,a){return a.title},sortable:!0},{key:"tested",label:"tested",sortByFormatted:!0,formatter:function(e,t,a){return Object(n["i"])(a.tested)},sortable:!0,class:"text-right"},{key:"passed",label:"✓ passed",sortByFormatted:!0,formatter:function(e,t,a){return Object(n["i"])(a.passed)},sortable:!0,class:"text-right"},{key:"failed",label:"✗ failed",sortByFormatted:!0,formatter:function(e,t,a){return Object(n["i"])(a.failed)},sortable:!0,class:"text-right"},{key:"actions",label:""}],s=function(e,t){return e&&"row"===t?0==Object(n["i"])(e.tested)?"table-light":Object(n["i"])(e.failed)>0?e.optional?"table-warning":"table-danger":"table-success":"table-light"},l=function(t){return e.dispatch("setSelectedID",t)},c=function(t){var a;return e.getters.descendantsOfID(null===t||void 0===t||null===(a=t.data)||void 0===a?void 0:a.id).some((function(e){var t;return(null===(t=e.data)||void 0===t?void 0:t.class)==C.CONTEXT}))},u=function(t){return e.getters.ancestorsOfNode(t).some((function(e){return e.data.class==C.PHASE}))},d=function(e){var t;return!!(null===e||void 0===e||null===(t=e.data)||void 0===t?void 0:t.period)},p=function(){function e(){var t=this,a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"New test",r=arguments.length>1&&void 0!==arguments[1]&&arguments[1];Object(Vt["a"])(this,e),this.id=a,this.title=a,this.optional=r,this.isBusy=Object(n["g"])(!1),this.tested=Object(n["g"])(0),this.failedIDs=Object(n["h"])([]),this.failed=Object(n["a"])((function(){return Object(n["i"])(t.failedIDs).length})),this.passed=Object(n["a"])((function(){return Object(n["i"])(t.tested)-Object(n["i"])(t.failed)}))}return Object($t["a"])(e,[{key:"rerun",value:function(){var e=Object(f["a"])(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return this.isBusy.value=!0,this.tested.value=0,this.failedIDs.value.length=0,e.next=5,this.test();case 5:t=e.sent,this.tested.value=t.tested||0,this.failedIDs.value=t.failedIDs||[],this.isBusy.value=!1;case 9:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"test",value:function(){var e=Object(f["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.abrupt("return",{tested:0,failedIDs:[]});case 1:case"end":return e.stop()}}),e)})));function t(){return e.apply(this,arguments)}return t}()}]),e}(),b=function(t){Object(Mt["a"])(r,t);var a=Object(zt["a"])(r);function r(){return Object(Vt["a"])(this,r),a.call(this,"Phases MUST contain at least one context",!1)}return Object($t["a"])(r,[{key:"test",value:function(){var t=Object(f["a"])(regeneratorRuntime.mark((function t(){var a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return a={tested:0,failedIDs:[]},e.getters.phases.forEach(function(){var e=Object(f["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:c(t)||a.failedIDs.push(t.data.id),a.tested++;case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),t.abrupt("return",a);case 3:case"end":return t.stop()}}),t)})));function a(){return t.apply(this,arguments)}return a}()}]),r}(p),m=function(t){Object(Mt["a"])(r,t);var a=Object(zt["a"])(r);function r(){return Object(Vt["a"])(this,r),a.call(this,"Phases SHOULD define a date range",!0)}return Object($t["a"])(r,[{key:"test",value:function(){var t=Object(f["a"])(regeneratorRuntime.mark((function t(){var a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return a={tested:0,failedIDs:[]},e.getters.phases.forEach(function(){var e=Object(f["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:t.data.dating.minYear&&t.data.dating.maxYear||a.failedIDs.push(t.data.id),a.tested++;case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),t.abrupt("return",a);case 3:case"end":return t.stop()}}),t)})));function a(){return t.apply(this,arguments)}return a}()}]),r}(p),g=function(t){Object(Mt["a"])(r,t);var a=Object(zt["a"])(r);function r(){return Object(Vt["a"])(this,r),a.call(this,"Phases SHOULD be allocated to a period",!0)}return Object($t["a"])(r,[{key:"test",value:function(){var t=Object(f["a"])(regeneratorRuntime.mark((function t(){var a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return a={tested:0,failedIDs:[]},e.getters.phases.forEach(function(){var e=Object(f["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:d(t)||a.failedIDs.push(t.data.id),a.tested++;case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),t.abrupt("return",a);case 3:case"end":return t.stop()}}),t)})));function a(){return t.apply(this,arguments)}return a}()}]),r}(p),v=function(t){Object(Mt["a"])(r,t);var a=Object(zt["a"])(r);function r(){return Object(Vt["a"])(this,r),a.call(this,"Groups MUST contain at least one context",!1)}return Object($t["a"])(r,[{key:"test",value:function(){var t=Object(f["a"])(regeneratorRuntime.mark((function t(){var a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return a={tested:0,failedIDs:[]},e.getters.groups.forEach(function(){var e=Object(f["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:c(t)||a.failedIDs.push(t.data.id),a.tested++;case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),t.abrupt("return",a);case 3:case"end":return t.stop()}}),t)})));function a(){return t.apply(this,arguments)}return a}()}]),r}(p),h=function(t){Object(Mt["a"])(r,t);var a=Object(zt["a"])(r);function r(){return Object(Vt["a"])(this,r),a.call(this,"Groups MUST be allocated to a phase",!1)}return Object($t["a"])(r,[{key:"test",value:function(){var t=Object(f["a"])(regeneratorRuntime.mark((function t(){var a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return a={tested:0,failedIDs:[]},e.getters.groups.forEach(function(){var e=Object(f["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:u(t)||a.failedIDs.push(t.data.id),a.tested++;case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),t.abrupt("return",a);case 3:case"end":return t.stop()}}),t)})));function a(){return t.apply(this,arguments)}return a}()}]),r}(p),y=function(t){Object(Mt["a"])(r,t);var a=Object(zt["a"])(r);function r(){return Object(Vt["a"])(this,r),a.call(this,"Groups SHOULD be allocated to a period",!0)}return Object($t["a"])(r,[{key:"test",value:function(){var t=Object(f["a"])(regeneratorRuntime.mark((function t(){var a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return a={tested:0,failedIDs:[]},e.getters.groups.forEach(function(){var e=Object(f["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:d(t)||a.failedIDs.push(t.data.id),a.tested++;case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),t.abrupt("return",a);case 3:case"end":return t.stop()}}),t)})));function a(){return t.apply(this,arguments)}return a}()}]),r}(p),x=function(t){Object(Mt["a"])(r,t);var a=Object(zt["a"])(r);function r(){return Object(Vt["a"])(this,r),a.call(this,"Subgroups MUST contain at least one context",!1)}return Object($t["a"])(r,[{key:"test",value:function(){var t=Object(f["a"])(regeneratorRuntime.mark((function t(){var a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return a={tested:0,failedIDs:[]},e.getters.subgroups.forEach(function(){var e=Object(f["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:c(t)||a.failedIDs.push(t.data.id),a.tested++;case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),t.abrupt("return",a);case 3:case"end":return t.stop()}}),t)})));function a(){return t.apply(this,arguments)}return a}()}]),r}(p),O=function(t){Object(Mt["a"])(r,t);var a=Object(zt["a"])(r);function r(){return Object(Vt["a"])(this,r),a.call(this,"Subgroups MUST be allocated to a group",!1)}return Object($t["a"])(r,[{key:"test",value:function(){var t=Object(f["a"])(regeneratorRuntime.mark((function t(){var a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return a={tested:0,failedIDs:[]},e.getters.subgroups.forEach(function(){var t=Object(f["a"])(regeneratorRuntime.mark((function t(r){var n,i;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:i=e.getters.nodeByID(r.data.parent),(null===i||void 0===i||null===(n=i.data)||void 0===n?void 0:n.class)!=C.GROUP&&a.failedIDs.push(r.data.id),a.tested++;case 3:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()),t.abrupt("return",a);case 3:case"end":return t.stop()}}),t)})));function a(){return t.apply(this,arguments)}return a}()}]),r}(p),w=function(t){Object(Mt["a"])(r,t);var a=Object(zt["a"])(r);function r(){return Object(Vt["a"])(this,r),a.call(this,"Subgroups MUST be allocated to a phase",!1)}return Object($t["a"])(r,[{key:"test",value:function(){var t=Object(f["a"])(regeneratorRuntime.mark((function t(){var a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return a={tested:0,failedIDs:[]},e.getters.subgroups.forEach(function(){var e=Object(f["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:u(t)||a.failedIDs.push(t.data.id),a.tested++;case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),t.abrupt("return",a);case 3:case"end":return t.stop()}}),t)})));function a(){return t.apply(this,arguments)}return a}()}]),r}(p),D=function(t){Object(Mt["a"])(r,t);var a=Object(zt["a"])(r);function r(){return Object(Vt["a"])(this,r),a.call(this,"Subgroups SHOULD be allocated to a period",!0)}return Object($t["a"])(r,[{key:"test",value:function(){var t=Object(f["a"])(regeneratorRuntime.mark((function t(){var a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return a={tested:0,failedIDs:[]},e.getters.subgroups.forEach(function(){var e=Object(f["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:d(t)||a.failedIDs.push(t.data.id),a.tested++;case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),t.abrupt("return",a);case 3:case"end":return t.stop()}}),t)})));function a(){return t.apply(this,arguments)}return a}()}]),r}(p),I=function(t){Object(Mt["a"])(r,t);var a=Object(zt["a"])(r);function r(){return Object(Vt["a"])(this,r),a.call(this,"Contexts MUST be allocated to a phase",!1)}return Object($t["a"])(r,[{key:"test",value:function(){var t=Object(f["a"])(regeneratorRuntime.mark((function t(){var a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return a={tested:0,failedIDs:[]},e.getters.contexts.forEach(function(){var e=Object(f["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:u(t)||a.failedIDs.push(t.data.id),a.tested++;case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),t.abrupt("return",a);case 3:case"end":return t.stop()}}),t)})));function a(){return t.apply(this,arguments)}return a}()}]),r}(p),k=function(t){Object(Mt["a"])(r,t);var a=Object(zt["a"])(r);function r(){return Object(Vt["a"])(this,r),a.call(this,"Contexts SHOULD be allocated to a period",!0)}return Object($t["a"])(r,[{key:"test",value:function(){var t=Object(f["a"])(regeneratorRuntime.mark((function t(){var a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return a={tested:0,failedIDs:[]},e.getters.contexts.forEach(function(){var e=Object(f["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:d(t)||a.failedIDs.push(t.data.id),a.tested++;case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),t.abrupt("return",a);case 3:case"end":return t.stop()}}),t)})));function a(){return t.apply(this,arguments)}return a}()}]),r}(p),j=function(t){Object(Mt["a"])(r,t);var a=Object(zt["a"])(r);function r(){return Object(Vt["a"])(this,r),a.call(this,"Contexts SHOULD have a type",!0)}return Object($t["a"])(r,[{key:"test",value:function(){var t=Object(f["a"])(regeneratorRuntime.mark((function t(){var a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return a={tested:0,failedIDs:[]},e.getters.contexts.forEach(function(){var e=Object(f["a"])(regeneratorRuntime.mark((function e(t){var r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:""==((null===(r=t.data)||void 0===r?void 0:r.type)||"").trim()&&a.failedIDs.push(t.data.id),a.tested++;case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),t.abrupt("return",a);case 3:case"end":return t.stop()}}),t)})));function a(){return t.apply(this,arguments)}return a}()}]),r}(p),S=function(t){Object(Mt["a"])(r,t);var a=Object(zt["a"])(r);function r(){return Object(Vt["a"])(this,r),a.call(this,"Context positions in diagram MUST reflect stratigraphy",!1)}return Object($t["a"])(r,[{key:"test",value:function(){var t=Object(f["a"])(regeneratorRuntime.mark((function t(){var a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return a={tested:0,failedIDs:[]},e.getters.edges.filter((function(e){return"above"==e.data.type})).forEach((function(t){var r=e.getters.nodeByID(t.data.source),n=e.getters.nodeByID(t.data.target);_(r)&&_(n)&&(r.position.y<n.position.y||a.failedIDs.push(t.data.id),a.tested++)})),t.abrupt("return",a);case 3:case"end":return t.stop()}}),t)})));function a(){return t.apply(this,arguments)}return a}()}]),r}(p),E=function(t){Object(Mt["a"])(r,t);var a=Object(zt["a"])(r);function r(){return Object(Vt["a"])(this,r),a.call(this,"Context stratigraphy supported by dating evidence?",!1)}return Object($t["a"])(r,[{key:"test",value:function(){var t=Object(f["a"])(regeneratorRuntime.mark((function t(){var a,r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return a={tested:0,failedIDs:[]},r=new Map,e.getters.datings.filter((function(e){return e.data.included})).forEach((function(t){var a=e.getters.enteredDatesForNode(t);if(T(a)){var n=r.get(t.data.parent)||{minYear:Number.POSITIVE_INFINITY,maxYear:Number.NEGATIVE_INFINITY};n.minYear>a.minYear&&(n.minYear=a.minYear),n.maxYear<a.maxYear&&(n.maxYear=a.maxYear),r.set(t.data.parent,n)}})),e.getters.edges.filter((function(e){return r.has(e.data.source)&&r.has(e.data.target)&&"above"==e.data.type})).forEach((function(e){var t=r.get(e.data.source),n=r.get(e.data.target);P(t,n)||a.failedIDs.push(e.data.id),a.tested++})),t.abrupt("return",a);case 5:case"end":return t.stop()}}),t)})));function a(){return t.apply(this,arguments)}return a}()}]),r}(p),Y=function(t){Object(Mt["a"])(r,t);var a=Object(zt["a"])(r);function r(){return Object(Vt["a"])(this,r),a.call(this,"Periods SHOULD define a date range",!0)}return Object($t["a"])(r,[{key:"test",value:function(){var t=Object(f["a"])(regeneratorRuntime.mark((function t(){var a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return a={tested:0,failedIDs:[]},e.getters.periods.forEach(function(){var e=Object(f["a"])(regeneratorRuntime.mark((function e(t){var r,n,i,o;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:null!=(null===(r=t.data)||void 0===r||null===(n=r.dating)||void 0===n?void 0:n.minYear)&&null!=(null===(i=t.data)||void 0===i||null===(o=i.dating)||void 0===o?void 0:o.maxYear)||a.failedIDs.push(t.data.id),a.tested++;case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),t.abrupt("return",a);case 3:case"end":return t.stop()}}),t)})));function a(){return t.apply(this,arguments)}return a}()}]),r}(p),N=[new b,new m,new g,new v,new h,new y,new x,new O,new w,new D,new I,new k,new j,new S,new E,new Y],R=function(){t.value=!0,Promise.allSettled(N.map(function(){var e=Object(f["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.abrupt("return",t.rerun());case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())).then((function(){return t.value=!1}))};return{isBusy:t,filter:a,sortBy:r,sortDesc:i,fields:o,tests:N,tableRowClass:s,refresh:R,setSelectedID:l,store:e}}},Ht=qt,Wt=(a("8555"),Object(Z["a"])(Ht,Ft,Gt,!1,null,"e4914e50",null)),Xt=Wt.exports,Kt=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("b-container",{staticClass:"p-2",attrs:{fluid:""}},[a("b-form-row",[a("b-col",[a("b-form-group",{attrs:{label:"Title","label-for":"title"}},[a("b-form-input",{staticClass:"shadow-sm",attrs:{placeholder:"(title)",type:"text",name:"title"},model:{value:e.title,callback:function(t){e.title=t},expression:"title"}})],1),a("b-form-group",{attrs:{label:"Description","label-for":"description"}},[a("b-form-textarea",{staticClass:"shadow-sm",attrs:{placeholder:"(description)",rows:"3","max-rows":"6",type:"text",name:"description"},model:{value:e.description,callback:function(t){e.description=t},expression:"description"}})],1),a("b-form-group",{attrs:{label:"Creator","label-for":"creator"}},[a("b-form-input",{staticClass:"shadow-sm",attrs:{placeholder:"(creator)",type:"text",name:"creator"},model:{value:e.creator,callback:function(t){e.creator=t},expression:"creator"}})],1),a("b-form-group",{attrs:{label:"Contact email address","label-for":"contact"}},[a("b-form-input",{staticClass:"shadow-sm",attrs:{placeholder:"(contact email address)",type:"email",name:"contact"},model:{value:e.contact,callback:function(t){e.contact=t},expression:"contact"}})],1),a("b-form-group",{attrs:{label:"License URL","label-for":"license"}},[a("b-form-input",{staticClass:"shadow-sm",attrs:{placeholder:"(license URL)",type:"url",name:"license"},model:{value:e.license,callback:function(t){e.license=t},expression:"license"}})],1),a("b-form-group",{attrs:{label:"Version","label-for":"version"}},[a("b-form-input",{staticClass:"shadow-sm",attrs:{placeholder:"(version)",type:"text",name:"version"},model:{value:e.version,callback:function(t){e.version=t},expression:"version"}})],1)],1)],1)],1)},Zt=[],Jt=(a("a4d3"),a("e01a"),{name:"MetaEditor",components:{},setup:function(){var e=Object(n["c"])("store"),t=Object(n["a"])({get:function(){return e.state.about.title},set:function(t){e.commit("SET_ABOUT",{title:t})}}),a=Object(n["a"])({get:function(){return e.state.about.description},set:function(t){e.commit("SET_ABOUT",{description:t})}}),r=Object(n["a"])({get:function(){return e.state.about.creator},set:function(t){e.commit("SET_ABOUT",{creator:t})}}),i=Object(n["a"])({get:function(){return e.state.about.contact},set:function(t){e.commit("SET_ABOUT",{contact:t})}}),o=Object(n["a"])({get:function(){return e.state.about.license},set:function(t){e.commit("SET_ABOUT",{license:t})}}),s=Object(n["a"])({get:function(){return e.state.about.version},set:function(t){e.commit("SET_ABOUT",{version:t})}});return{store:e,title:t,description:a,creator:r,contact:i,license:o,version:s}}}),Qt=Jt,ea=Object(Z["a"])(Qt,Kt,Zt,!1,null,null,null),ta=ea.exports,aa=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("b-form",{on:{submit:e.onSubmit,reset:e.onReset}},[a("b-dropdown",{ref:"nodeClassOptionsDropdown",staticClass:"m-2",attrs:{block:"",text:e.searchElementHeader,"menu-class":"w-100",variant:"primary"}},[a("b-form-checkbox-group",{staticClass:"shadow-sm ml-4",attrs:{stacked:"",name:"nodeClassSelection",disabled:e.isSearchDisabled,options:e.nodeClassOptions},model:{value:e.selectedNodeClasses,callback:function(t){e.selectedNodeClasses=t},expression:"selectedNodeClasses"}})],1),a("b-dropdown",{staticClass:"m-2 p-0",attrs:{block:"",text:e.searchWithinHeader,"menu-class":"w-100",variant:"primary"}},[a("b-form-select",{staticClass:"p-0 m-0",attrs:{"select-size":8,disabled:e.isSearchDisabled,options:e.nodeParentOptions},model:{value:e.selectedNodeParent,callback:function(t){e.selectedNodeParent=t},expression:"selectedNodeParent"}})],1),a("b-button-toolbar",[a("b-button",{staticClass:"m-2",attrs:{block:"",variant:"primary",type:"submit",disabled:e.isSearchDisabled},on:{click:e.onSubmit}},[e._v("Search")]),a("b-button",{staticClass:"m-2",attrs:{block:"",variant:"primary",type:"reset",disabled:e.isResetDisabled},on:{click:e.onReset}},[e._v("Reset")])],1)],1),a("div",[e._v("Results ("+e._s(e.searchResults.length)+")")]),a("b-pagination",{attrs:{"total-rows":e.rowCount,"per-page":e.perPage,"aria-controls":"my-table","first-number":!0,"last-number":!0},model:{value:e.currentPage,callback:function(t){e.currentPage=t},expression:"currentPage"}}),a("b-table",{staticClass:"overflow-auto shadow-sm",staticStyle:{height:"600px"},attrs:{"show-empty":"",small:"",striped:"",hover:"",outlined:"",selectable:"","sort-icon-left":"",id:"datatable-searchresults","no-border-collapse":!0,"sticky-header":!0,"per-page":e.perPage,"current-page":e.currentPage,"primary-key":"data.id",items:e.searchResults,fields:e.fields,"no-select-on-click":!0},on:{"row-selected":e.rowSelected},scopedSlots:e._u([{key:"thead-top",fn:function(){return[a("b-tr",[a("b-th",{attrs:{colspan:"4"}},[a("span",{staticClass:"sr-only"},[e._v("xx")])]),a("b-th",{staticClass:"text-center",attrs:{variant:"secondary",colspan:"3"}},[e._v("entered dates")]),a("b-th",{staticClass:"text-center",attrs:{variant:"primary",colspan:"3"}},[e._v("derived dates")])],1)]},proxy:!0},{key:"cell(id)",fn:function(t){return[a("a",{attrs:{href:"#"},on:{click:function(a){return a.stopPropagation(),e.store.dispatch("setSelectedID",t.item.data.id)}}},[e._v(e._s(e.store.getters.labelByID(t.item.data.id,!0)))])]}},{key:"cell(parent)",fn:function(t){return[a("a",{attrs:{href:"#"},on:{click:function(a){return a.stopPropagation(),e.store.dispatch("setSelectedID",t.item.data.parent)}}},[e._v(e._s(e.store.getters.labelByID(t.item.data.parent,!0)))])]}}])})],1)},ra=[],na={components:{},props:{},setup:function(){var e=Object(n["c"])("store"),t=Object(n["g"])(!1),a=25,r=Object(n["g"])(1),i=Object(n["a"])((function(){return c.value.length})),o=[C.PHASE,C.GROUP,C.SUBGROUP,C.CONTEXT,C.DATING],s=Object(n["g"])(""),l=Object(n["g"])([]),c=Object(n["g"])([]),u=Object(n["a"])((function(){return"Elements (".concat(Object(n["i"])(l).length>0?Object(n["i"])(l).join(", "):"none",")")})),d=Object(n["a"])((function(){var t="(any)";return s.value&&(t=e.getters.labelByID(Object(n["i"])(s),!0)),"Within ".concat(t)})),p=Object(n["a"])((function(){return[{value:"",text:"(any)",selected:!0}].concat(e.getters.phaseOptionsGrouped).concat(e.getters.groupOptionsGrouped).concat(e.getters.subgroupOptionsGrouped)})),f=function(a){a.preventDefault(),t.value=!0;var r=[];r=s.value?e.getters.descendantsOfID(s.value):e.getters.nodes,c.value=r.filter((function(e){return-1!==Object(n["i"])(l).indexOf(e.data.class)})),t.value=!1},b=function(e){e.preventDefault(),l.value=[],s.value="",c.value=[],t.value=!1},m=Object(n["a"])((function(){return!1})),g=Object(n["a"])((function(){return""==s.value&&0==l.value.length})),v=function(){},h=Object(n["a"])((function(){return[{key:"id",label:"id",sortable:!0},{key:"data.type",label:"type",sortable:!0},{key:"parent",label:"within",sortByFormatted:!0,sortable:!0},{key:"period",label:"period",sortByFormatted:!0,formatter:y,sortable:!0},{key:"minyear",label:"min year",sortByFormatted:!0,formatter:O,sortable:!0,class:"text-right",variant:"secondary"},{key:"maxyear",label:"max year",sortByFormatted:!0,formatter:w,sortable:!0,class:"text-right",variant:"secondary"},{key:"entereddiff",label:"duration",sortByFormatted:!0,formatter:j,sortable:!0,class:"text-right",variant:"secondary"},{key:"derivedminyear",label:"min year",sortByFormatted:!0,formatter:D,sortable:!0,class:"text-right",variant:"primary"},{key:"derivedmaxyear",label:"max year",sortByFormatted:!0,formatter:I,sortable:!0,class:"text-right",variant:"primary"},{key:"duration",label:"duration",sortByFormatted:!0,formatter:k,sortable:!0,class:"text-right",variant:"primary"}]})),y=function(t,a,r){return e.getters.labelByID(r.data.period,!1)},x=function(e,t,a){return null==e||""==e?"":0==t?Number(e):"".concat(e,"±").concat(t).concat("years"==a?"y":"%")},O=function(e,t,a){var r,n=(null===(r=a.data)||void 0===r?void 0:r.dating)||{},i=n.minYear,o=n.minYearTolValue,s=n.minYearTolUnit;return x(i,o,s)},w=function(e,t,a){var r,n=(null===(r=a.data)||void 0===r?void 0:r.dating)||{},i=n.maxYear,o=n.maxYearTolValue,s=n.maxYearTolUnit;return x(i,o,s)},D=function(t,a,r){return e.getters.derivedDates(r.data.id).minYear},I=function(t,a,r){return e.getters.derivedDates(r.data.id).maxYear},k=function(t,a,r){return e.getters.derivedDuration(r.data.id)},j=function(t,a,r){return e.getters.enteredDuration(r.data.id)},S=function(t,a,r){return e.getters.derivedMinDuration(r.data.id)},E=function(t,a,r){return e.getters.derivedMaxDuration(r.data.id)};return{store:e,perPage:a,currentPage:r,rowCount:i,nodeClassOptions:o,searchElementHeader:u,searchWithinHeader:d,nodeParentOptions:p,selectedNodeParent:s,selectedNodeClasses:l,onSubmit:f,onReset:b,isSearchDisabled:m,isResetDisabled:g,searchResults:c,rowSelected:v,fields:h,derivedMinYearFormatter:D,derivedMaxYearFormatter:I,durationFormatter:k,derivedMinDurationFormatter:S,derivedMaxDurationFormatter:E,tablePeriodFormatter:y}}},ia=na,oa=(a("e07e"),Object(Z["a"])(ia,aa,ra,!1,null,"aea99056",null)),sa=oa.exports,la=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("b-container",{staticClass:"p-2",attrs:{fluid:""}},[a("b-row",{attrs:{"align-h":"between"}},[a("b-col",{staticStyle:{"text-align":"left"}},[a("b-input-group",{attrs:{prepend:"Phase"}},[a("b-form-select",{staticClass:"shadow-sm",attrs:{plain:!0,name:"phase-selector",options:e.phaseLookupOptions,placeholder:"select phase"},model:{value:e.selectedPhaseID,callback:function(t){e.selectedPhaseID=t},expression:"selectedPhaseID"}})],1)],1),a("b-col",[a("b-input-group",{scopedSlots:e._u([{key:"prepend",fn:function(){return[a("b-icon-search",{staticClass:"m-2",attrs:{height:"20"}})]},proxy:!0}])},[a("b-form-input",{staticClass:"shadow-sm",attrs:{size:"md",id:"filter-input",disabled:!e.selectedPhaseID,type:"search",autocomplete:"off",placeholder:"filter results"},model:{value:e.filter,callback:function(t){e.filter=t},expression:"filter"}})],1)],1)],1),a("b-row",[a("b-col",[a("PhaseDTR",{attrs:{phaseID:e.selectedPhaseID,filter:e.filter}})],1)],1),a("b-row",[a("b-col",[a("PhaseDSR",{attrs:{phaseID:e.selectedPhaseID,filter:e.filter}})],1)],1)],1)},ca=[],ua=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("b-container",{staticClass:"p-0 m-0",attrs:{fluid:""}},[a("b-row",[a("b-col",[a("div",{staticClass:"p-2 text-center"},[e._v("Derived temporal relationships between elements within phase "+e._s(e.selectedPhaseLabel))])])],1),a("b-row",{attrs:{"align-h":"between"}},[a("b-col",[a("b-table",{staticClass:"overflow-auto shadow-sm",staticStyle:{height:"250px"},attrs:{"show-empty":"","sort-icon-left":"",hover:"",outlined:"",selectable:"",small:"",id:"datatable-temporal",busy:e.isBusy,"no-border-collapse":!0,"sticky-header":!0,"select-mode":"single","filter-ignored-fields":["source","target"],"filter-included-fields":["sourceLabel","relationship","targetLabel"],filter:e.filter,items:e.items,fields:e.fields},scopedSlots:e._u([{key:"cell(sourceLabel)",fn:function(t){return[a("a",{attrs:{href:"#"},on:{click:function(a){return a.stopPropagation(),e.store.dispatch("setSelectedID",t.item.source)}}},[e._v(e._s(t.item.sourceLabel))])]}},{key:"cell(targetLabel)",fn:function(t){return[a("a",{attrs:{href:"#"},on:{click:function(a){return a.stopPropagation(),e.store.dispatch("setSelectedID",t.item.target)}}},[e._v(e._s(t.item.targetLabel))])]}},{key:"cell(sourceDates)",fn:function(t){return[a("span",[e._v("(")]),a("span",[e._v(e._s(t.item.sourceDates.minYear))]),a("b-icon-arrow-right-short"),a("span",[e._v(e._s(t.item.sourceDates.maxYear))]),a("span",[e._v(")")])]}},{key:"cell(targetDates)",fn:function(t){return[a("span",[e._v("(")]),a("span",[e._v(e._s(t.item.targetDates.minYear))]),a("b-icon-arrow-right-short"),a("span",[e._v(e._s(t.item.targetDates.maxYear))]),a("span",[e._v(")")])]}}])})],1)],1)],1)},da=[],pa={props:{phaseID:{type:String,required:!1,default:""},filter:{type:String,required:!1,default:""}},setup:function(e){var t=Object(n["c"])("store"),a=Object(n["g"])([]),r=Object(n["g"])(!1),i=[{key:"sourceLabel",label:"source",sortable:!0},{key:"sourceDates",label:"",sortable:!1},{key:"relationship",label:"relationship",sortable:!0},{key:"targetLabel",label:"target",sortable:!0},{key:"targetDates",label:"",sortable:!1}],o=Object(n["a"])((function(){return t.getters.labelByID(e.phaseID)})),s=Object(n["a"])((function(){return e.phaseID}));Object(n["j"])(s,function(){var e=Object(f["a"])(regeneratorRuntime.mark((function e(t){var n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return r.value=!0,a.value=[],e.next=4,l(t);case 4:n=e.sent,a.value=n,r.value=!1;case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());var l=function(){var e=Object(f["a"])(regeneratorRuntime.mark((function e(a){var r,n,i;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(r=[],n=t.getters.nodeByID(a),n){e.next=4;break}return e.abrupt("return",r);case 4:return i=new Map,t.getters.descendantsOfID(a).filter((function(e){return[C.GROUP,C.SUBGROUP,C.CONTEXT].includes(e.data.class)})).forEach((function(e){var a=t.getters.derivedNodeDates(e.data.id);T(a)&&i.set(e.data.id,a)})),i.forEach((function(e,a){var n=t.getters.labelByID(a,!0);i.forEach((function(i,o){a!==o&&r.push({source:a,target:o,sourceLabel:n,targetLabel:t.getters.labelByID(o,!0),sourceDates:e,targetDates:i,relationship:q(e,i)})}))})),e.abrupt("return",r);case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return{store:t,fields:i,selectedPhaseLabel:o,items:a,isBusy:r}}},fa=pa,ba=(a("bd20"),Object(Z["a"])(fa,ua,da,!1,null,"0b40c854",null)),ma=ba.exports,ga=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("b-container",{staticClass:"p-0 m-0",attrs:{fluid:""}},[a("b-row",[a("b-col",[a("div",{staticClass:"p-2 text-center"},[e._v("Derived stratigraphic relationships between elements within phase "+e._s(e.selectedPhaseLabel))])])],1),a("b-row",{attrs:{"align-h":"between"}},[a("b-col",[a("b-table",{staticClass:"overflow-auto shadow-sm",staticStyle:{height:"250px"},attrs:{"sort-icon-left":"",hover:"",outlined:"",selectable:"",small:"",busy:e.isBusy,"show-empty":"",id:"datatable-temporal","no-border-collapse":!0,"sticky-header":!0,"select-mode":"single","filter-ignored-fields":["sourceID","targetID"],"filter-included-fields":["sourceLabel","relationship","targetLabel"],filter:e.filter,items:e.items,fields:e.fields,"tbody-tr-class":e.rowClass},scopedSlots:e._u([{key:"cell(sourceLabel)",fn:function(t){return[a("a",{attrs:{href:"#"},on:{click:function(a){return a.stopPropagation(),e.store.dispatch("setSelectedID",t.item.sourceID)}}},[e._v(e._s(t.item.sourceLabel))])]}},{key:"cell(targetLabel)",fn:function(t){return[a("a",{attrs:{href:"#"},on:{click:function(a){return a.stopPropagation(),e.store.dispatch("setSelectedID",t.item.targetID)}}},[e._v(e._s(t.item.targetLabel))])]}},{key:"cell(sourceDates)",fn:function(t){return[a("span",[e._v("(")]),null!==t.item.sourceDates.minYear&&null!==t.item.sourceDates.maxYear?a("span",[a("span",[e._v(e._s(t.item.sourceDates.minYear))]),a("b-icon-arrow-right-short"),a("span",[e._v(e._s(t.item.sourceDates.maxYear))])],1):a("span",[e._v("no dates")]),a("span",[e._v(")")])]}},{key:"cell(targetDates)",fn:function(t){return[a("span",[e._v("(")]),null!==t.item.targetDates.minYear&&null!==t.item.targetDates.maxYear?a("span",[a("span",[e._v(e._s(t.item.targetDates.minYear))]),a("b-icon-arrow-right-short"),a("span",[e._v(e._s(t.item.targetDates.maxYear))])],1):a("span",[e._v("no dates")]),a("span",[e._v(")")])]}}])})],1)],1)],1)},va=[],ha=(a("6062"),{props:{phaseID:{type:String,required:!1,default:""},filter:{type:String,required:!1,default:""}},setup:function(e){var t=Object(n["c"])("store"),a=Object(n["g"])([]),r=Object(n["g"])(!1),i=Object(n["a"])((function(){return t.getters.labelByID(e.phaseID)})),o=function(e,t){if(e&&"row"===t){var a=q(e.sourceDates,e.targetDates);return""==a?void 0:[w.AFTER,w.METBY].includes(a)&&e.relationship==D.ABOVE||[w.BEFORE,w.MEETS].includes(a)&&e.relationship==D.BELOW?"table-success":"table-danger"}},s=[{key:"sourceLabel",label:"source",sortable:!0},{key:"sourceDates",label:"",sortable:!1},{key:"relationship",label:"relationship",sortable:!0},{key:"targetLabel",label:"target",sortable:!0},{key:"targetDates",label:"",sortable:!1}],l=Object(n["a"])((function(){return e.phaseID}));Object(n["j"])(l,function(){var e=Object(f["a"])(regeneratorRuntime.mark((function e(t){var n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return r.value=!0,a.value=[],e.next=4,c(t);case 4:n=e.sent,a.value=n,r.value=!1;case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());var c=function(){var e=Object(f["a"])(regeneratorRuntime.mark((function e(a){var r,n,i;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(r=[],n=t.getters.nodeByID(a),n){e.next=4;break}return e.abrupt("return",r);case 4:return i=new Map,t.getters.descendantsOfID(a).filter(_).forEach((function(e){var a=t.getters.ancestorsOfNode(e).map((function(e){return e.data.id})).concat(e.data.id);i.set(e.data.id,a)})),t.getters.edges.filter((function(e){return i.has(e.data.source)&&i.has(e.data.target)})).filter((function(e){return e.data.type===D.ABOVE})).forEach((function(e){var a=new Set(i.get(e.data.source)),n=new Set(i.get(e.data.target));a.forEach((function(e){n.has(e)&&(a.delete(e),n.delete(e))})),a.forEach((function(e){var a=t.getters.labelByID(e,!0),i=t.getters.derivedNodeDates(e);n.forEach((function(n){var o=t.getters.labelByID(n,!0),s=t.getters.derivedNodeDates(n);r.push({sourceID:e,targetID:n,sourceLabel:a,targetLabel:o,sourceDates:i,targetDates:s,relationship:D.ABOVE}),r.push({sourceID:n,targetID:e,sourceLabel:o,targetLabel:a,sourceDates:s,targetDates:i,relationship:D.BELOW})}))}))})),e.abrupt("return",r);case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return{store:t,fields:s,selectedPhaseLabel:i,items:a,isBusy:r,rowClass:o}}}),ya=ha,xa=(a("25c4"),Object(Z["a"])(ya,ga,va,!1,null,"72afa1fc",null)),Oa=xa.exports,wa={components:{PhaseDTR:ma,PhaseDSR:Oa},setup:function(){var e=Object(n["c"])("store"),t=Object(n["g"])(""),a=Object(n["g"])(""),r=Object(n["a"])((function(){return e.getters.labelByID(a.value)})),i=Object(n["a"])((function(){return e.getters.phaseOptions.concat({value:"",text:"(none)",selected:!0})}));return{store:e,filter:t,phaseLookupOptions:i,selectedPhaseID:a,selectedPhaseLabel:r}}},Da=wa,Ca=Object(Z["a"])(Da,la,ca,!1,null,null,null),Ia=Ca.exports,ka={components:{ItemEditor:Ut,ValidationAsync:Xt,MetaEditor:ta,SearchControls:sa,TemporalRelationships:Ia},setup:function(){var e=Object(n["c"])("store"),t=Object(n["g"])(0),a=Object(n["a"])((function(){return e.getters.selectedID})),r=Object.values(C),i=function(t){switch(t){case C.PHASE:return e.getters.phases.length;case C.GROUP:return e.getters.groups.length;case C.SUBGROUP:return e.getters.subgroups.length;case C.CONTEXT:return e.getters.contexts.length;case C.DATING:return e.getters.datings.length;case C.PERIOD:return e.getters.periods.length;case"edge":return e.getters.edges.length;default:return 0}};return Object(n["j"])(a,(function(a){if(e.getters.isNode(a)){var r,n=null===(r=e.getters.nodeByID(a).data)||void 0===r?void 0:r.class;switch(n){case C.PHASE:t.value=0;break;case C.GROUP:t.value=1;break;case C.SUBGROUP:t.value=2;break;case C.CONTEXT:t.value=3;break;case C.DATING:t.value=4;break;case C.PERIOD:t.value=5;break}}else{if(!e.getters.isEdge(a))return;t.value=6}})),{tabIndex:t,selectedID:a,nodeClasses:r,itemCount:i,capitalize:x}}},ja=ka,Sa=Object(Z["a"])(ja,he,ye,!1,null,null,null),Ea=Sa.exports,Ya=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("b-overlay",{attrs:{show:e.busy,rounded:"sm"}},[a("div",{staticClass:"overflow-auto position-relative",attrs:{id:"holder"}},[a("Lock",{staticClass:"position-absolute m-2",attrs:{id:"lock"},on:{input:e.lockChanged},model:{value:e.locked,callback:function(t){e.locked=t},expression:"locked"}}),a("Legend",{staticClass:"position-absolute m-2",attrs:{id:"legend"}}),a("cytoscape",{ref:"cy",attrs:{id:"diagram",config:e.config,preConfig:e.preConfig,afterCreated:e.afterCreated}},[e._l(e.nodes,(function(t){return a("cy-element",{key:t.data.id,class:t.data.class,attrs:{id:"node.data.id",definition:t,sync:!0},on:{click:function(a){return e.elementSelected(a,t)}}})})),e._l(e.edges,(function(t){return a("cy-element",{key:t.data.id,class:t.data.class,attrs:{definition:t},on:{click:function(a){return e.elementSelected(a,t)}}})}))],2)],1)])},_a=[],Ta=a("b17d"),Na=a.n(Ta),Pa=a("8d3a"),Ra=a.n(Pa),Ba=a("7436"),La=a.n(Ba),Aa=a("1e16"),Ua=a.n(Aa),Fa=a("cc5f"),Ga=a.n(Fa),Ma=a("1157"),za=a.n(Ma),Va=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("b-card",{directives:[{name:"b-toggle",rawName:"v-b-toggle.legendItems",modifiers:{legendItems:!0}}],staticClass:" legend card text-secondary shadow",attrs:{"no-body":""}},[a("div",{staticClass:"card-header px-3 py-1"},[a("b-icon-key",{staticClass:"mr-2"}),e._v("Key")],1),a("b-collapse",{staticClass:"card-body m-0 px-3 py-1",attrs:{id:"legendItems"}},[a("b-list-group",{staticClass:"bg-light",attrs:{flush:""}},e._l(e.items,(function(t,r){return a("b-list-group-item",{key:r,staticClass:"m-0 p-0 border-0"},[a("svg",{attrs:{height:"15",width:"30"}},[a("rect",{attrs:{x:"1",y:"1",width:"26",height:"11","stroke-width":"2",fill:t.fillColor,stroke:t.borderColor,"stroke-dasharray":t.dashed?"2 2":""}}),a("text",{attrs:{x:"7",y:"10",fill:t.textColor,"font-size":"9"}},[e._v("123")])]),a("span",{staticClass:"ml-1"},[e._v(e._s(t.label))])])})),1)],1)],1)},$a=[],qa={setup:function(){var e=[{label:"Phase",fillColor:"transparent",borderColor:"red",textColor:"red",dashed:!0},{label:"Group",fillColor:"honeydew",borderColor:"green",textColor:"green"},{label:"Sub-Group",fillColor:"aliceblue",borderColor:"blue",textColor:"blue"},{label:"Context (undated)",fillColor:"white",borderColor:"black",textColor:"black"},{label:"Context (dated)",fillColor:"black",borderColor:"black",textColor:"white"},{label:"Selected",fillColor:"gold",borderColor:"black",textColor:"black"}];return{items:e}}},Ha=qa,Wa=(a("87b1"),Object(Z["a"])(Ha,Va,$a,!1,null,"58eda963",null)),Xa=Wa.exports,Ka=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{attrs:{id:"lock",title:e.locked?"locked":"unlocked",alt:e.locked?"locked":"unlocked"}},[a("b-form-checkbox",{staticClass:"shadow",attrs:{button:"",checked:e.value,disabled:e.disabled,"button-variant":e.locked?"success":"danger"},on:{input:e.changed}},[e.locked?a("b-icon-lock-fill"):a("b-icon-unlock-fill")],1)],1)},Za=[],Ja={props:{disabled:{type:Boolean,required:!1,default:!1},value:{type:Boolean,required:!1,default:!0}},setup:function(e,t){var a=Object(n["g"])(e.value),r=function(e){a.value=e,t.emit("input",e)};return{locked:a,changed:r}}},Qa=Ja,er=(a("d7c6"),Object(Z["a"])(Qa,Ka,Za,!1,null,"2ae95fde",null)),tr=er.exports,ar={components:{Legend:Xa,Lock:tr},props:{gridSize:{type:Number,required:!1,default:40}},setup:function(e){var t=Object(n["c"])("store"),a=Object(n["h"])(null),r=Object(n["g"])(!1),i=Object(n["g"])(!0),o={pixelRation:1,selectionType:"single",minZoom:.05,maxZoom:2,hideEdgesOnViewport:!0,textureOnViewport:!0,panzoom:{zoomFactor:.05,zoomDelay:45,minZoom:.05,maxZoom:2,fitPadding:50,panSpeed:20,panDistance:20,panDragAreaSize:75,panMinPercentSpeed:.25,panInactiveArea:8,panIndicatorMinOpacity:.5,zoomOnly:!1,fitSelector:void 0,sliderHandleIcon:"fa fa-minus",zoomInIcon:"fa fa-plus",zoomOutIcon:"fa fa-minus",resetIcon:"fa fa-expand"},navigator:{container:"#navigator",viewLiveFramerate:1,thumbnailEventFramerate:1,thumbnailLiveFramerate:1,dblClickDelay:200,removeCustomContainer:!1,rerenderDelay:100},gridguide:{snapToGridOnRelease:!1,snapToGridDuringDrag:!0,snapToAlignmentLocationOnRelease:!1,snapToAlignmentLocationDuringDrag:!1,distributionGuidelines:!0,geometricGuideline:!0,initPosAlignment:!1,centerToEdgeAlignment:!1,resize:!1,parentPadding:!1,drawGrid:!0,gridSpacing:e.gridSize,snapToGridCenter:!0,zoomDash:!0,panGrid:!0,gridStackOrder:0,gridColor:"#dedede",lineWidth:1,guidelinesStackOrder:4,guidelinesTolerance:2,guidelinesStyle:{strokeStyle:"#8b7d6b",geometricGuidelineRange:400,range:100,minDistRange:10,distGuidelineOffset:10,horizontalDistColor:"#ff0000",verticalDistColor:"#00ff00",initPosAlignmentColor:"#0000ff",lineDash:[0,0],horizontalDistLine:[0,0],verticalDistLine:[0,0],initPosAlignmentLine:[0,0]},parentSpacing:-1},layoutDagre:{name:"dagre",nodeSep:e.gridSize-4,rankSep:e.gridSize-4,marginx:e.gridSize/2,marginy:e.gridSize/2,rankDir:"TB",ranker:"network-simplex",minLen:function(e){return 1},fit:!1,padding:e.gridSize/2,spacingFactor:void 0,nodeDimensionsIncludeLabels:!1,animate:!1,boundingBox:void 0,ready:function(){},stop:k},layoutElk:{name:"elk",nodeDimensionsIncludeLabels:!1,fit:!1,padding:e.gridSize/2,animate:!1,animationDuration:500,animationEasing:void 0,transform:function(e,t){return t},ready:void 0,stop:void 0,elk:{algorithm:"layered",alignment:"LEFT",layered:{unnecessaryBendpoints:!0},mrtree:{searchOrder:"DFS",weighting:"DESCENDANTS"}}},layoutKlay:{name:"klay",nodeDimensionsIncludeLabels:!1,fit:!1,padding:e.gridSize/2,animate:!1,animateFilter:function(){return!0},animationDuration:500,animationEasing:void 0,transform:function(e,t){return t},ready:void 0,stop:void 0,klay:{addUnnecessaryBendpoints:!1,aspectRatio:1.6,borderSpacing:20,compactComponents:!1,crossingMinimization:"LAYER_SWEEP",cycleBreaking:"GREEDY",direction:"DOWN",edgeRouting:"ORTHOGONAL",edgeSpacingFactor:.5,feedbackEdges:!1,fixedAlignment:"NONE",inLayerSpacingFactor:1,layoutHierarchy:!1,linearSegmentsDeflectionDampening:.3,mergeEdges:!1,mergeHierarchyCrossingEdges:!0,nodeLayering:"NETWORK_SIMPLEX",nodePlacement:"BRANDES_KOEPF",randomizationSeed:1,routeSelfLoopInside:!1,separateConnectedComponents:!0,spacing:20,thoroughness:7},priority:function(){return null}},layoutBreadthFirst:{name:"breadthfirst",fit:!1,directed:!0,padding:e.gridSize/2,circle:!1,grid:!1,boundingBox:void 0,avoidOverlap:!0,nodeDimensionsIncludeLabels:!1,roots:void 0,maximal:!0,animate:!1,animationDuration:500,animationEasing:void 0,animateFilter:function(){return!0},ready:void 0,stop:void 0,transform:function(e,t){return t}},style:[{selector:"node",style:{"min-zoomed-font-size":"1em","font-family":"Arial","font-size":"2em",shape:"rectangle",width:3*e.gridSize,height:1*e.gridSize,padding:0,"text-opacity":1,"text-valign":"center","text-halign":"center",color:"black","background-color":"white","background-opacity":1,"border-color":"black","border-width":"4px","border-style":"solid","border-opacity":1}},{selector:'node[class="'.concat(C.CONTEXT,'"]'),style:{width:3*e.gridSize,height:1*e.gridSize,label:function(e){return"".concat(e.data("label")?e.data("label"):e.data("id"))},color:function(e){return t.getters.hasDating(e.data("id"))?"white":"black"},"background-color":function(e){return t.getters.hasDating(e.data("id"))?"black":"white"}}},{selector:'node[class="'.concat(C.CONTEXT,'"]:selected'),style:{"background-color":"gold",color:"black"}},{selector:'node[class="'.concat(C.PHASE,'"]'),style:{width:"600px","text-opacity":.75,"text-valign":"top","text-halign":"right","text-margin-x":5,"text-margin-y":15,padding:e.gridSize,color:"gray","background-opacity":0,"background-color":"transparent","border-color":"lightgray","border-width":"0px"}},{selector:'node[class="'.concat(C.PHASE,'"]:selected'),style:{"background-color":"gold","background-opacity":1}},{selector:'node[class="'.concat(C.GROUP,'"]'),style:{label:function(e){return"".concat(e.data("label")?e.data("label"):e.data("id"))},"text-opacity":.75,"text-valign":"top","text-halign":"right","text-margin-x":5,"text-margin-y":15,color:"green","background-color":"honeydew","border-color":"green"}},{selector:'node[class="'.concat(C.GROUP,'"]:selected'),style:{"background-color":"gold"}},{selector:'node[class="'.concat(C.SUBGROUP,'"]'),style:{"text-opacity":.75,"text-valign":"center","text-halign":"right","text-margin-x":5,"text-justification":"auto",color:"blue","background-color":"aliceblue","border-color":"blue"}},{selector:'node[class="'.concat(C.SUBGROUP,'"]:selected'),style:{"background-color":"gold"}},{selector:"edge",style:{"curve-style":"taxi","taxi-direction":"downward","taxi-turn":e.gridSize/2,"edge-distances":"intersection","taxi-turn-min-distance":e.gridSize/2,"source-endpoint":"outside-to-node","target-endpoint":"outside-to-node",width:3,"line-color":"gray","line-style":"solid"}},{selector:"edge.connected",style:{"line-color":"darkred",width:8}},{selector:'edge[class="derived"]',style:{"curve-style":"haystack","line-color":"blue","line-style":"dashed",visibility:"hidden"}},{selector:"edge:selected",style:{"line-color":"gold"}}]},s=Object(n["a"])((function(){return t.getters.selectedID}));Object(n["j"])(s,(function(e,t){var r=a.value.instance;if(r){var n=r.$id(t);n&&(n.unselect(),n.connectedEdges().removeClass("connected")),n=r.$id(e),n&&(n.select(),n.connectedEdges().addClass("connected"))}}));var l=Object(n["a"])((function(){return[].concat(t.getters.phases).concat(t.getters.groups).concat(t.getters.subgroups).concat(t.getters.contexts)})),c=Object(n["a"])((function(){return t.getters.edges.filter((function(e){return"above"==e.data.type}))})),u=function(e){e.use(Na.a),e.use(Ra.a),e.use(La.a),e.use(Ua.a),e.use(Ga.a),e.use(za.a)},d=function(e,a){var r;return t.dispatch("setSelectedID",(null===(r=a.data)||void 0===r?void 0:r.id)||"")},p=function(e){e.panzoom(o.panzoom),e.gridGuide(o.gridguide),e.nodeHtmlLabel([{query:'node[class="subgroup"]',halign:"right",valign:"center",halignBox:"right",valignBox:"center",tpl:function(e){return'<span class="subgrouplabel">'.concat(e.label||e.id,"</span>")}}])},b=function(e){return g(e,!1)},m=function(e){return g(e,!0)},g=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(e){var a=e.png({full:t,output:"blob"}),r="phaser-".concat(I(),".png"),n=new Blob([a],{type:"image/png"});if(navigator.msSaveBlob)navigator.msSaveBlob(n,r);else{var i=document.createElement("a");if(void 0!==i.download){var o=URL.createObjectURL(n);i.setAttribute("href",o),i.setAttribute("download",r),i.style.visibility="hidden",document.body.appendChild(i),i.click(),document.body.removeChild(i)}}}},v=function(e){h(e)},h=function(e){e.zoom(1),e.pan({x:0,y:0})},y=function(e){e&&e.fit()},x=function(e){return w(e,1.25)},O=function(e){return w(e,.75)},w=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;e&&e.zoom({level:e.zoom()*t,position:{x:Math.round((e.extent().x1+e.extent().x2)/2),y:Math.round((e.extent().y1+e.extent().y2)/2)}})},D=function(e){e&&!i.value&&(r.value=!0,v(e),e.layout(o.layoutDagre).run(),r.value=!1)},k=function(){var e=Object(f["a"])(regeneratorRuntime.mark((function e(){var n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(n=a.value.instance,n){e.next=3;break}return e.abrupt("return");case 3:n.elements("node").forEach((function(e){t.dispatch("updateNode",{data:e.data(),position:e.position()})})),r.value=!1;case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),j=function(e){var t=a.value.instance;t&&(i.value=e,t.autolock(e))},S=function(e){if(e){var t=e.cyCanvas(),a=t.getCanvas(),r=a.getContext("2d");e.on("render cyCanvas.resize pan",(function(){t.resetTransform(r),t.clear(r),t.setTransform(r);var a=e.extent();e.nodes('[class = "phase"]').sort((function(e,t){var a,r;return(null===(a=e.data().dating)||void 0===a?void 0:a.maxYear)-(null===(r=t.data().dating)||void 0===r?void 0:r.maxYear)})).forEach((function(e){var t=2*a.w,n=e.layoutDimensions().h,i=a.x1,o=e.position().y-n/2;r.strokeStyle="red",r.lineWidth=2,r.setLineDash([8,4]),r.beginPath(),r.moveTo(i,o),r.lineTo(t,o),r.stroke(),r.font="2em Arial",r.textBaseline="top",r.fillStyle="red";var s=e.data().label;r.textAlign="left",r.fillText(s,a.x1+10,o+10),r.textAlign="right",r.fillText(s,a.x2-10,o+10)}))}))}};return Object(n["f"])((function(){var e=a.value.instance;e&&(e.autolock(i.value),S(e),document.getElementById("cytoscape-div").style.minHeight="900px",fe.$on("diagram-clear",(function(){return v(e)})),fe.$on("diagram-zoom-in",(function(){return x(e)})),fe.$on("diagram-zoom-out",(function(){return O(e)})),fe.$on("diagram-zoom-fit",(function(){return y(e)})),fe.$on("diagram-export-part-png",(function(){return b(e)})),fe.$on("diagram-export-full-png",(function(){return m(e)})),fe.$on("diagram-redo-layout",(function(t){return D(e,t)})),fe.$on("diagram=-redo-compound-layout",(function(a){var r=e.$id(a.data.id);if(r){var n=r.boundingBox(),i={x:n.x1,y:n.y1},s=r.descendants(),l=s.edgesWith(s);s.merge(l).layout(o.layoutDagre).run();var c=r.boundingBox(),u={x:i.x+c.w/2-5,y:i.y+c.h/2};r.position(u),t.dispatch("updateNode",{data:a.data,position:u})}})),fe.$on("node-parent-changed",(function(t){var a=e.$id(t.data.id);a&&""!==t.data.parent?a.move({parent:t.data.parent}):a.move({parent:null})})))})),Object(n["d"])((function(){var e=a.value.instance;e.elements("node").forEach((function(e){t.dispatch("updateNode",{data:e.data(),position:e.position()})}))})),{cy:a,busy:r,locked:i,config:o,nodes:l,edges:c,preConfig:u,afterCreated:p,layoutStop:k,lockChanged:j,elementSelected:d}}},rr=ar,nr=(a("fc76"),Object(Z["a"])(rr,Ya,_a,!1,null,null,null)),ir=nr.exports,or=a("9a78"),sr=a.n(or),lr={components:{MenuBar:ve,ItemEditors:Ea,MatrixDiagramCY:ir,VueSplitter:sr.a},setup:function(){var e=Object(n["c"])("store");Object(n["f"])((function(){return document.title="".concat(e.getters.appName," v").concat(e.getters.appVersion)}))}},cr=lr,ur=(a("034f"),Object(Z["a"])(cr,i,o,!1,null,null,null)),dr=ur.exports,pr=a("5f5b"),fr=a("b1e0"),br=(a("f9e3"),a("2dd8"),a("2f62")),mr=a("1625");r["default"].use(br["a"]);var gr=[Object(mr["a"])({paths:["about","nodes","edges"]})],vr={appName:"Phaser",appVersion:"1.10",selectedID:"",about:{title:"",description:"",creator:"",contact:"",license:"",version:""},nodes:{},edges:{},types:Object.freeze({groupTypes:["Building","Corn-drying oven","Ditch overall","Drain","Four-post structure","Hearth","Kiln","Oven","Post-hole: group","Road","Structure","Well"],contextTypes:["Animal disturbance","Animal disturbance: fill","Ard mark","Ard mark: fill","Bank","Beam slot","Beam slot: fill","Beam","Coffin","Coffin: fill","Coffin: stain","Corn-drying oven: cut","Corn-drying oven: fill","Corn-drying oven: wall","Cremation pit","Cremation pit: fill","Cremation vessel","Cremation vessel: fill","Cremation","Ditch segment","Ditch segment: fill","Ditch","Ditch: fill","Drain: capping","Drain: construction trench fill","Drain: construction trench","Drain: fill","Drain: lining","Drain: packing","Drain: pipe","Drove way","Enclosure","Feature","Feature: fill","Floor","Floor: tessellated","Flue","Flue: fill","Foundation: cut","Foundation: layer","Furnace","Grave","Grave: fill","Gully","Gully: fill","Hearth pit","Hearth pit: fill","Hearth: debris","Hoof print","Hoof print: fill","Interface","Kiln: debris","Kiln: fill","Kiln: lining","Layer","Layer: accumulation","Layer: buried soil","Layer: levelling","Layer: natural","Layer: occupation","Layer: plough soil","Layer: redeposited natural","Layer: rubble","Layer: subsoil","Layer: topsoil","Lens","Linear feature","Linear feature: fill","Modern intrusion","Modern intrusion: fill","Natural feature","Natural feature: fill","Palaeochannel","Palaeochannel: fill","Pit","Pit, cess","Pit, cess: fill","Pit: fill","Pit: lining","Plough furrow","Plough furrow: fill","Plough mark","Plough mark: fill","Post-hole","Post-hole: fill","Post-hole: packing","Post-pad","Post-pipe","Post-pipe: fill","Pottery: spread","Quarry pit","Quarry pit: fill","Ring ditch","Robbing trench","Robbing trench: fill","Stake","Stake-hole","Stake-hole: fill","Stoke hole","Stoke hole: fill","Surface","Surface: earth/clay","Surface: metalled","Surface: mortar","Surface: paved","Threshold","Tree hollow","Tree hollow: fill","Trial trench","Trial trench: fill","Vessel","Vessel: fill","Wall","Wall: construction trench fill","Wall: construction trench","Well: construction pit fill","Well: construction pit","Well: fill","Well: lining","Wheel rut","Wheel rut: fill"],datingTypes:["find","sample","manual"]})},hr=function(e,t){return e.text>t.text?1:-1},yr=function(e){return e.map((function(e){return{value:e,text:e}}))},xr={appName:function(e){return e.appName},appVersion:function(e){return e.appVersion},selectedID:function(e){return e.selectedID},about:function(e){return e.about},nodes:function(e){return Object.values(e.nodes).filter((function(e){return e}))},edges:function(e){return Object.values(e.edges).filter((function(e){return e}))},isNode:function(e){return function(t){return Object.hasOwn(e.nodes,t)}},isEdge:function(e){return function(t){return Object.hasOwn(e.edges,t)}},nodeByID:function(e){return function(t){return e.nodes[t]||null}},edgeByID:function(e){return function(t){return e.edges[t]||null}},edgesBySource:function(e,t){return function(e){return t.edges.filter((function(t){return t.data.source===e}))}},edgesByTarget:function(e,t){return function(e){return t.edges.filter((function(t){return t.data.target===e}))}},phases:function(e,t){return t.nodes.filter((function(e){return e.data.class===C.PHASE}))},groups:function(e,t){return t.nodes.filter((function(e){return e.data.class===C.GROUP}))},subgroups:function(e,t){return t.nodes.filter((function(e){return e.data.class===C.SUBGROUP}))},contexts:function(e,t){return t.nodes.filter((function(e){return e.data.class===C.CONTEXT}))},datings:function(e,t){return t.nodes.filter((function(e){return e.data.class===C.DATING}))},periods:function(e,t){return t.nodes.filter((function(e){return e.data.class===C.PERIOD}))},labelByID:function(e,t){return function(e){var a=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(t.isNode(e)){var r=t.nodeByID(e);return t.nodeLabel(r,a)}if(t.isEdge(e)){var n=t.edgeByID(e);return t.edgeLabel(n,a)}return e}},nodeLabel:function(){return function(e){var t,a,r=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!e)return"";var n=S(null===(t=e.data)||void 0===t?void 0:t.class),i=S(null===(a=e.data)||void 0===a?void 0:a.label);return r?"(".concat(n,") ").concat(i):i}},edgeLabel:function(e,t){return function(e){var a,r,n,i=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!e)return"";var o=t.labelByID(null===(a=e.data)||void 0===a?void 0:a.source,i),s=t.labelByID(null===(r=e.data)||void 0===r?void 0:r.target,i),l=S(null===(n=e.data)||void 0===n?void 0:n.type);return"".concat(o," ").concat(l," ").concat(s)}},hasDating:function(e,t){return function(e){return t.descendantsOfID(e).filter((function(e){return e.data.class===C.DATING})).length>0}},groupTypeOptions:function(){return yr(vr.types.groupTypes)},contextTypeOptions:function(){return yr(vr.types.contextTypes)},datingTypeOptions:function(){return yr(vr.types.datingTypes)},phaseOptions:function(e,t){return t.phases.map((function(e){return{value:e.data.id,text:t.nodeLabel(e,!0)}})).sort(hr)},groupOptions:function(e,t){return t.groups.map((function(e){return{value:e.data.id,text:t.nodeLabel(e,!0)}})).sort(hr)},subgroupOptions:function(e,t){return t.subgroups.map((function(e){return{value:e.data.id,text:t.nodeLabel(e,!0)}})).sort(hr)},contextOptions:function(e,t){return t.contexts.map((function(e){return{value:e.data.id,text:t.nodeLabel(e,!0)}})).sort(hr)},periodOptions:function(e,t){return t.periods.map((function(e){return{value:e.data.id,text:"".concat(e.data.label)}})).sort(hr)},phaseOptionsGrouped:function(e,t){return 0==t.phaseOptions.length?[]:[{label:"Phases",options:t.phaseOptions}]},groupOptionsGrouped:function(e,t){return 0==t.groupOptions.length?[]:[{label:"Groups",options:t.groupOptions}]},subgroupOptionsGrouped:function(e,t){return 0==t.subgroupOptions.length?[]:[{label:"Subgroups",options:t.subgroupOptions}]},contextOptionsGrouped:function(e,t){return 0==t.contextOptions.length?[]:[{label:"Contexts",options:t.contextOptions}]},periodOptionsGrouped:function(e,t){return 0==t.periodOptions.length?[]:[{label:"Periods",options:t.periodOptions}]},contextParentOptions:function(e,t){return[].concat(Object(d["a"])(t.phaseOptionsGrouped),Object(d["a"])(t.groupOptionsGrouped),Object(d["a"])(t.subgroupOptionsGrouped))},childrenOfIDs:function(e,t){return function(e){return t.nodes.filter((function(t){return e.includes(t.data.parent)}))}},childrenOfID:function(e,t){return function(e){return t.nodes.filter((function(t){return t.data.parent==e}))}},descendantsOfIDs:function(e,t){return function(e){var a=[],r=t.childrenOfIDs(e),n=0;while(r.length>0&&n<5)a.push.apply(a,Object(d["a"])(r)),r=t.childrenOfIDs(r.map((function(e){return e.data.id}))),n++;return a}},descendantsOfID:function(e,t){return function(e){return t.descendantsOfIDs([e])}},ancestorsOfID:function(e,t){return function(e){var a=t.nodeByID(e);return t.ancestorsOfNode(a)}},ancestorsOfNode:function(e,t){return function(e){var a,r=[],n=0;if(!e)return[];var i=t.nodeByID(null===(a=e.data)||void 0===a?void 0:a.parent);while(i&&n<5){var o;r.push(i),i=t.nodeByID(null===(o=i.data)||void 0===o?void 0:o.parent),n++}return r}},derivedEdges:function(e,t){var a=new Map;return t.edges.filter((function(e){return"above"==e.data.type})).forEach((function(e){var r=new Set(t.ancestorsOfID(e.data.source).map((function(e){return e.data.id}))),n=new Set(t.ancestorsOfID(e.data.target).map((function(e){return e.data.id})));r.add(e.data.source),n.add(e.data.target),r.forEach((function(e){n.has(e)&&r.delete(e),n.delete(e)})),r.forEach((function(e){n.forEach((function(t){var r="edge-".concat(k(e),"-").concat(k(t));a.has(r)||a.set(r,{data:{id:r,source:e,target:t,type:"above"}})}))}))})),Object(d["a"])(a.values())},enteredDatesForID:function(e,t){return function(e){var a=t.nodeByID(e);return t.enteredDatesForNode(a)}},enteredDatesForNode:function(){return function(e){var t,a=(null===e||void 0===e||null===(t=e.data)||void 0===t?void 0:t.dating)||{},r={minYear:Number(a.minYear||Number.POSITIVE_INFINITY),maxYear:Number(a.maxYear||Number.NEGATIVE_INFINITY),minYearTolValue:Number(a.minYearTolValue||0),maxYearTolValue:Number(a.maxYearTolValue||0),minYearTolUnit:(a.minYearTolUnit||"years").trim().toLowerCase(),maxYearTolUnit:(a.maxYearTolUnit||"years").trim().toLowerCase()};return r.minYear<Number.POSITIVE_INFINITY&&0!==r.minYearTolValue&&("percent"==r.minYearTolUnit?r.minYear-=r.minYear*(r.minYearTolValue/100):r.minYear-=r.minYearTolValue),r.maxYear>Number.NEGATIVE_INFINITY&&0!==r.maxYearTolValue&&("percent"==r.maxYearTolUnit?r.maxYear+=r.maxYear*(r.maxYearTolValue/100):r.maxYear+=r.maxYearTolValue),{minYear:r.minYear<Number.POSITIVE_INFINITY?Math.round(r.minYear):null,maxYear:r.maxYear>Number.NEGATIVE_INFINITY?Math.round(r.maxYear):null}}},derivedDates:function(e,t){return function(e){return t.isNode(e)?t.derivedNodeDates(e):t.isEdge(e)?t.derivedEdgeDates(e):{minYear:null,maxYear:null}}},derivedEdgeDates:function(e,t){return function(e){var a=t.edgeByID(e);if(!a)return{minYear:null,maxYear:null};var r=t.derivedNodeDates(a.data.source),n=t.derivedNodeDates(a.data.target);return{minYear:n.maxYear?n.maxYear+1:null,maxYear:r.minYear?r.minYear-1:null}}},derivedNodeDates:function(e,t){return function(e){var a=Number.POSITIVE_INFINITY,r=Number.NEGATIVE_INFINITY;return t.descendantsOfID(e).filter((function(e){return e.data.class==C.DATING&&e.data.included&&e.data.dating})).forEach((function(e){var n=t.enteredDatesForNode(e);n.minYear<a&&(a=n.minYear),n.maxYear>r&&(r=n.maxYear)})),{minYear:a<Number.POSITIVE_INFINITY?Math.round(a):null,maxYear:r>Number.NEGATIVE_INFINITY?Math.round(r):null}}},derivedDuration:function(e,t){return function(e){var a=t.derivedDates(e);return null!==a.maxYear&&null!==a.minYear?a.maxYear-a.minYear+1:null}},derivedMinDuration:function(e,t){return function(e){var a=t.edgeByID(e);if(!a)return{minYear:null,maxYear:null};var r=t.derivedNodeDates(a.data.source),n=t.derivedNodeDates(a.data.target);return null!==r.minYear&&null!==n.maxYear?r.minYear-n.maxYear:null}},derivedMaxDuration:function(e,t){return function(e){var a=t.edgeByID(e);if(!a)return{minYear:null,maxYear:null};var r=t.derivedNodeDates(a.data.source),n=t.derivedNodeDates(a.data.target);return null!==r.maxYear&&null!==n.minYear?r.maxYear-n.minYear:null}},enteredDuration:function(e,t){return function(e){var a=t.enteredDatesForID(e);return null!==a.maxYear&&null!==a.minYear?a.maxYear-a.minYear+1:null}},newPhase:function(e,t){var a=C.PHASE,r=1;while(t.isNode("".concat(a,"-").concat(r)))r++;var n="".concat(a,"-").concat(r);return{data:{id:n,class:a,label:r.toString(),description:"",dating:{label:"",minYear:null,maxYear:null,minYearTolValue:0,maxYearTolValue:0,minYearTolUnit:"years",maxYearTolUnit:"years"}},position:{x:0,y:0}}},newGroup:function(e,t){var a=C.GROUP,r=1;while(t.isNode("".concat(a,"-").concat(r)))r++;var n="".concat(a,"-").concat(r);return{data:{id:n,class:a,parent:"",type:"",cud:"",label:r.toString(),description:""},position:{x:0,y:0}}},newSubGroup:function(e,t){var a=C.SUBGROUP,r=1;while(t.isNode("".concat(a,"-").concat(r)))r++;var n="".concat(a,"-").concat(r);return{data:{id:n,class:a,parent:"",type:"",cud:"",label:r.toString(),description:""},position:{x:0,y:0}}},newContext:function(e,t){var a=C.CONTEXT,r=1;while(t.isNode("".concat(a,"-").concat(r)))r++;var n="".concat(a,"-").concat(r);return{data:{id:n,class:a,parent:"",type:"",cud:"",label:r.toString(),description:""},position:{x:0,y:0}}},newDating:function(e,t){var a=C.DATING,r=1;while(t.isNode("".concat(a,"-").concat(r)))r++;var n="".concat(a,"-").concat(r);return{data:{id:n,class:a,parent:"",type:"",label:r.toString(),description:"",included:!0,association:"direct",dating:{label:"",minYear:null,maxYear:null,minYearTolValue:0,maxYearTolValue:0,minYearTolUnit:"years",maxYearTolUnit:"years"}}}},newPeriod:function(e,t){var a=C.PERIOD,r=1;while(t.isNode("".concat(a,"-").concat(r)))r++;var n="".concat(a,"-").concat(r);return{data:{id:n,class:a,label:"",uri:"",description:"",dating:{label:"",minYear:null,maxYear:null,minYearTolValue:0,maxYearTolValue:0,minYearTolUnit:"years",maxYearTolUnit:"years"}}}},newEdge:function(e,t){var a=1;while(t.isEdge("edge-".concat(a)))a++;var r="edge-".concat(a);return{data:{id:r,class:"",source:"source",target:"target",type:"above"}}}},Or={loadMatrixData:function(e,t){return Object(f["a"])(regeneratorRuntime.mark((function a(){var r,n,i,o,s,l,c,u,d;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return r=e.commit,n=e.getters,i=e.dispatch,a.next=3,i("clearAll",r);case 3:o=t.about||{},r("SET_ABOUT",o),s=t.elements?t.elements:t,l=s.nodes||[],c=s.edges||[],u=l.map((function(e){var t,a=null,r=(null===(t=e.data)||void 0===t?void 0:t.class)||"";switch(r){case C.PHASE:a=n.newPhase;break;case C.GROUP:a=n.newGroup;break;case C.SUBGROUP:a=n.newSubGroup;break;case C.CONTEXT:a=n.newContext;break;case C.DATING:a=n.newDating;break;default:break}return null!==a?W()({},a,e):null})).map((function(e){return e})),d=c.map((function(e){return W()({},n.newEdge,e)})),r("BULK_LOAD_ELEMENTS",{nodes:u,edges:d});case 11:case"end":return a.stop()}}),a)})))()},clearAll:function(e){var t=e.commit;t("SET_ABOUT",{title:"",description:"",creator:"",contact:"",license:"",version:""}),t("DELETE_NODES"),t("DELETE_EDGES"),Promise.resolve()},insertNode:function(e,t){var a=e.commit,r=e.dispatch;a("UPDATE_NODE",t),r("setSelectedID",t.data.id,a),Promise.resolve()},insertNodes:function(e,t){var a=e.commit;t.forEach((function(e){return a("UPDATE_NODE",e)})),Promise.resolve()},updateNode:function(e,t){var a=e.commit;a("UPDATE_NODE",t)},setSelectedID:function(e,t){var a=e.commit;a("SELECT_ID",t)},deleteNode:function(e,t){var a=e.commit,r=e.getters,n=r.edgesBySource(t.data.id),i=r.edgesByTarget(t.data.id);n.concat(i).forEach((function(e){return a("DELETE_EDGE",e)})),a("DELETE_NODE",t)},createEdge:function(e){var t=e.commit,a=e.dispatch,r=e.getters,n=r.newEdge;a("insertEdge",n,t)},insertEdge:function(e){var t=e.commit,a=e.getters,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=W()({},a.newEdge,r);n.data.id||(n.data.id="edge-".concat(k(n.data.source||"source"),"-").concat(k(n.data.target||"target"))),t("UPDATE_EDGE",n)},insertEdges:function(e,t){var a=e.commit,r=e.dispatch;t.forEach((function(e){return r("insertEdge",e,a)})),Promise.resolve()},updateEdge:function(e,t){var a=e.commit;a("UPDATE_EDGE",t)},deleteEdge:function(e,t){var a=e.commit;a("DELETE_EDGE",t)},insertPhase:function(e){var t=e.commit,a=e.dispatch,r=e.getters,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=W()({},r.newPhase,n);a("insertNode",i,t)},insertGroup:function(e){var t=e.commit,a=e.dispatch,r=e.getters,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=W()({},r.newGroup,n);a("insertNode",i,t)},insertSubGroup:function(e){var t=e.commit,a=e.dispatch,r=e.getters,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=W()({},r.newSubGroup,n);a("insertNode",i,t)},insertContext:function(e){var t=e.commit,a=e.dispatch,r=e.getters,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=W()({},r.newContext,n);a("insertNode",i,t)},insertDating:function(e){var t=e.commit,a=e.dispatch,r=e.getters,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=W()({},r.newDating,n);a("insertNode",i,t)},insertPeriod:function(e){var t=e.commit,a=e.dispatch,r=e.getters,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=W()({},r.newPeriod,n);a("insertNode",i,t)}},wr={SET_ABOUT:function(e,t){e.about=Object.assign({},e.about,t)},SELECT_ID:function(e,t){e.selectedID=t||""},BULK_LOAD_ELEMENTS:function(e,t){var a=Object.assign({},e.nodes),n=Object.assign({},e.edges);(t.nodes||[]).forEach((function(e){var t,r=(null===e||void 0===e||null===(t=e.data)||void 0===t?void 0:t.id)||null;null!==r&&(a[r]=e)})),(t.edges||[]).forEach((function(e){var t,a=(null===e||void 0===e||null===(t=e.data)||void 0===t?void 0:t.id)||null;null!==a&&(n[a]=e)})),r["default"].set(e,"nodes",a),r["default"].set(e,"edges",n)},UPDATE_NODE:function(e,t){var a,n=(null===t||void 0===t||null===(a=t.data)||void 0===a?void 0:a.id)||null;null!==n&&r["default"].set(e.nodes,n,t)},DELETE_NODE:function(e,t){var a,n=(null===t||void 0===t||null===(a=t.data)||void 0===a?void 0:a.id)||null;Object.hasOwn(e.nodes,n)&&r["default"].set(e.nodes,n,null)},DELETE_NODES:function(e){e.nodes={}},UPDATE_EDGE:function(e,t){var a,n=(null===t||void 0===t||null===(a=t.data)||void 0===a?void 0:a.id)||null;null!==n&&r["default"].set(e.edges,n,t)},DELETE_EDGE:function(e,t){var a,n=(null===t||void 0===t||null===(a=t.data)||void 0===a?void 0:a.id)||null;Object.hasOwn(e.edges,n)&&r["default"].set(e.edges,n,null)},DELETE_EDGES:function(e){e.edges={}}},Dr=new br["a"].Store({plugins:gr,state:vr,getters:xr,actions:Or,mutations:wr}),Cr=a("3a6f"),Ir=a.n(Cr);r["default"].use(n["b"]),r["default"].use(pr["a"]),r["default"].use(fr["a"]),r["default"].use(Ir.a),r["default"].config.productionTip=!1,new r["default"]({provide:{store:Dr},render:function(e){return e(dr)}}).$mount("#app")},5759:function(e,t,a){},6681:function(e,t,a){},"68f0":function(e,t,a){},"7ffc":function(e,t,a){},8555:function(e,t,a){"use strict";var r=a("1a40"),n=a.n(r);n.a},"85ec":function(e,t,a){},"87b1":function(e,t,a){"use strict";var r=a("7ffc"),n=a.n(r);n.a},"8f9b":function(e,t,a){},a347:function(e,t,a){"use strict";var r=a("2674"),n=a.n(r);n.a},b8b2:function(e,t,a){"use strict";var r=a("eb36"),n=a.n(r);n.a},bd20:function(e,t,a){"use strict";var r=a("e78e"),n=a.n(r);n.a},c8fe:function(e,t,a){},d7c6:function(e,t,a){"use strict";var r=a("6681"),n=a.n(r);n.a},e07e:function(e,t,a){"use strict";var r=a("f7e1"),n=a.n(r);n.a},e732:function(e,t,a){"use strict";var r=a("5759"),n=a.n(r);n.a},e78e:function(e,t,a){},eb36:function(e,t,a){},ee23:function(e,t,a){},ef14:function(e,t,a){"use strict";var r=a("ee23"),n=a.n(r);n.a},f7e1:function(e,t,a){},fc76:function(e,t,a){"use strict";var r=a("8f9b"),n=a.n(r);n.a}});